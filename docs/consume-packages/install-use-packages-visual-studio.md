---
title: Установка пакетов NuGet и управление ими в Visual Studio
description: Инструкции по применению пользовательского интерфейса диспетчера пакетов NuGet в Visual Studio для работы с пакетами NuGet.
author: karann-msft
ms.author: karann
ms.date: 07/08/2019
ms.topic: conceptual
f1_keywords:
- vs.toolsoptionspages.nuget_package_manager
- vs.toolsoptionspages.nuget_package_manager.general
- vs.toolsoptionspages.nuget_package_manager.package_sources
- vs.nuget.packagemanager.ui
ms.openlocfilehash: 3adceac8c725d9ea1610aea090753c9c1d8bc818
ms.sourcegitcommit: ddb52131e84dd54db199ce8331f6da18aa3feea1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/16/2020
ms.locfileid: "79428423"
---
# <a name="install-and-manage-packages-in-visual-studio-using-the-nuget-package-manager"></a>Устанавливайте пакеты и управляйте ими непосредственно в Visual Studio с помощью диспетчера пакетов NuGet.

С помощью пользовательского интерфейса диспетчера пакетов NuGet в Visual Studio вы можете легко устанавливать, удалять и обновлять пакеты NuGet в проектах и решениях в ОС Windows. Если вы используете Visual Studio для Mac, см. руководство по [включению пакета NuGet в проект](/visualstudio/mac/nuget-walkthrough?toc=/nuget/toc.json). Пользовательский интерфейс диспетчера пакетов не входит в Visual Studio Code.

> [!NOTE]
> Если у вас нет диспетчера пакетов NuGet в Visual Studio 2015, щелкните **Средства > Расширения и обновления** и найдите расширение *Диспетчер пакетов NuGet*. Если вы не можете использовать установщик расширений в Visual Studio, скачайте расширение отсюда: [https://dist.nuget.org/index.html](https://dist.nuget.org/index.html).
>
> Начиная с Visual Studio 2017, NuGet и диспетчер пакетов NuGet автоматически устанавливаются с любыми рабочими нагрузками, связанными с .NET. Установите его отдельно, щелкнув **Отдельные компоненты > Средства для работы с кодом > Диспетчер пакетов NuGet** в установщике Visual Studio.

## <a name="find-and-install-a-package"></a>Поиск и установка пакета

1. В **обозревателе решений** щелкните правой кнопкой мыши **Ссылки** или сам проект и выберите **Управление пакетами NuGet**.

    ![Пункт меню "Управление пакетами NuGet"](media/ManagePackagesUICommand.png)

1. На вкладке **Обзор** по популярности отображаются пакеты из выбранного в данный момент источника (см. подробнее об [источниках пакетов](#package-sources)). Выполните поиск определенного пакета с помощью поля поиска в левом верхнем углу. Выберите пакет в списке, чтобы отобразить сведения о нем. Это также активирует кнопку **Установить** и раскрывающийся список для выбора версии.

    ![Вкладка "Обзор" в диалоговом окне "Управление пакетами NuGet"](media/Search.png)

1. Выберите нужную версию в раскрывающемся списке и щелкните **Установить**. Visual Studio установит пакет и его зависимости в проект. Может появиться запрос на принятие условий лицензионного соглашения. После завершения установки добавленные пакеты отобразятся на вкладке **Установленные**. Пакеты также перечислены в узле **Ссылки** обозревателя решений. Это значит, что их можно указывать в проекте с помощью инструкций `using`.

    ![Ссылки в обозревателе решений](media/References.png)

> [!Tip]
> Чтобы включить предварительные версии в поиск и сделать их доступными в раскрывающемся списке версий, щелкните **Включить предварительные версии**.

> [!Note]
> У NuGet есть два формата, в которых пакеты могут использоваться в проекте: [`PackageReference`](package-references-in-project-files.md) и [`packages.config`](../reference/packages-config.md). [Значение по умолчанию можно задать в окне параметров Visual Studio](Package-Restore.md#choose-default-package-management-format).

## <a name="uninstall-a-package"></a>Удаление пакета

1. В **обозревателе решений** щелкните правой кнопкой мыши **Ссылки** или сам проект и выберите **Управление пакетами NuGet**.
1. Откройте вкладку **Установленные**.
1. Выберите пакет для удаления (при необходимости используйте поиск, чтобы отфильтровать список) и щелкните **Удалить**.

    ![Удаление пакета](media/UninstallPackage.png)

1. Обратите внимание, что элементы управления **Включить предварительные версии** и **Источник пакета** не применяются при удалении пакетов.

## <a name="update-a-package"></a>Обновление пакета

1. В **обозревателе решений** щелкните правой кнопкой мыши **Ссылки** или сам проект и выберите **Управление пакетами NuGet**. (В проектах веб-сайтов щелкните правой кнопкой мыши папку **Bin**.)
1. Перейдите на вкладку **Обновления**, чтобы просмотреть пакеты, для которых доступны обновления из выбранных источников пакетов. Выберите **Включить предварительные версии**, чтобы включить предварительные версии пакетов в список обновлений.
1. Последовательно выберите пакет для обновления и нужную версию в раскрывающемся списке справа, а затем щелкните **Обновить**.

    ![Обновление пакета](media/UpdatePackages.png)

1. <a name="implicit_reference"></a>Для некоторых пакетов отключена кнопка **Обновить**. При этом появляется сообщение "На этот пакет неявно ссылается пакет SDK" (AutoReferenced). Это сообщение означает, что пакет является частью более крупной платформы или пакета SDK и не должен обновляться отдельно. (Такие пакеты отмечаются атрибутом `<IsImplicitlyDefined>True</IsImplicitlyDefined>`). Например, `Microsoft.NETCore.App` является частью пакета SDK для .NET Core, и версия пакета не совпадает с версией платформы среды выполнения, используемой приложением. Необходимо [обновить установку .NET Core](https://aka.ms/dotnet-download), чтобы получить новые версии ASP.NET Core и среды выполнения .NET Core. См. подробнее о [метапакетах и управлении версиями .NET Core](/dotnet/core/packages). Это относится к следующим часто используемым пакетам:
    * Microsoft.AspNetCore.All
    * Microsoft.AspNetCore.App
    * Microsoft.NETCore.App
    * NETStandard.Library

    ![Пример пакета, отмеченного как неявная ссылка или AutoReferenced](media/PackageManagerUIAutoReferenced.png)

1. Чтобы обновить несколько пакетов до последних версий, выберите их в списке и нажмите кнопку **Обновить**, расположенную над списком.
1. Кроме того, можно обновить отдельный пакет на вкладке **Установленные**. В этом случае сведения о пакете будут содержать средство выбора версии (зависит от параметра **Включить предварительные версии**) и кнопку **Обновить**.

## <a name="manage-packages-for-the-solution"></a>Управление пакетами для решения

Управление пакетами для решения — это удобный способ одновременно работать с несколькими проектами.

1. Выберите команду меню **Средства > Диспетчер пакетов NuGet > Управление пакетами NuGet для решения** или щелкните правой кнопкой мыши решение и выберите **Управление пакетами NuGet**.

    ![Управление пакетами NuGet для решения](media/ManagePackagesSolutionUICommand.png)

1. При управлении пакетами для решения пользовательский интерфейс позволяет выбрать проекты, затрагиваемые операциями.

    ![Выбор проекта при управлении пакетами для решения](media/SolutionPackagesUI.png)

### <a name="consolidate-tab"></a>Вкладка "Консолидация"

Разработчики обычно предпочитают не использовать разные версии одного и того же пакета NuGet в разных проектах в одном решении. Когда вы выбираете управление пакетами для решения, в пользовательском интерфейсе диспетчера пакетов появляется вкладка **Консолидация**, на которой вы можете отслеживать использование пакетов с разными номерами версий разными проектами в решении.

![Вкладка "Консолидация" пользовательского интерфейса диспетчера пакетов](media/ConsolidateTab.png)

В этом примере проект ClassLibrary1 использует EntityFramework 6.2.0, а ConsoleApp1 использует EntityFramework 6.1.0. Для консолидации версий пакета сделайте следующее:

- Выберите проекты для обновления в списке проектов.
- Выберите версию, которая будет использоваться во всех проектах в элементе управления **Версия**, например EntityFramework 6.2.0.
- Нажмите кнопку **Установить**.

Диспетчер пакетов устанавливает выбранную версию пакета во все выбранные проекты. После этого пакет больше не будет отображаться на вкладке **Консолидация**.

## <a name="package-sources"></a>Источники пакетов

Чтобы изменить источник, из которого Visual Studio получает пакеты, выберите его в средстве выбора источника.

![Средство выбора источника пакетов в пользовательском интерфейсе диспетчера пакетов](media/PackageSourceDropDown.png)

Для управления источниками пакетов сделайте следующее:

1. Щелкните значок **Параметры** в пользовательском интерфейсе диспетчера пакетов, как показано ниже, или выберите **Средства > Параметры** и прокрутите до пункта **Диспетчер пакетов NuGet**.

    ![Значок параметров пользовательского интерфейса диспетчера пакетов](media/PackageSourceSettings.png)

1. Выберите узел **Источники пакетов**.

    ![Параметры источников пакетов](media/options.png)

1. Чтобы добавить источник, выберите **+** , измените имя, введите URL-адрес или путь в элементе управления **Источник** и щелкните **Обновить**. Источник отобразится в раскрывающемся списке для выбора.
1. Чтобы изменить источник пакета, выберите его, внесите изменения в поля **Имя** и **Источник** и щелкните **Обновить**.
1. Чтобы отключить источник пакета, снимите флажок слева от имени в списке.
1. Чтобы удалить источник пакета, выберите его и нажмите кнопку **X**.
1. Использование кнопок со стрелками вверх и вниз не меняет приоритетный порядок источников пакетов. Visual Studio игнорирует порядок источников пакетов, используя пакет из любого источника, первым ответившего на запросы. См. подробнее о [восстановлении пакетов](../consume-packages/package-restore.md).

> [!Tip]
> Если источник пакета появляется после удаления, он может быть указан в файлах `NuGet.Config` уровня компьютера или уровня пользователя. Чтобы определить расположение этих файлов, см. описание [распространенных конфигураций NuGet](../consume-packages/configuring-nuget-behavior.md). Затем удалите источник, отредактировав файлы вручную или с помощью команды [nuget sources](../reference/nuget-exe-CLI-reference.md).

## <a name="package-manager-options-control"></a>Элемент управления "Параметры" диспетчера пакетов

Если пакет выбран, пользовательский интерфейс диспетчера пакетов отображает небольшой развертываемый элемент управления **Параметры** под средством выбора версий (показан в свернутом и развернутом виде). Обратите внимание, что для некоторых типов проектов предоставляется только параметр **Показать окно предварительного просмотра**.

![Параметры диспетчера пакетов](media/PackageManagerUIOptions.png)

Эти параметры объясняются в следующих разделах.

### <a name="show-preview-window"></a>Показать окно предварительного просмотра

При выборе этого параметра модальное окно отображает зависимости выбранного пакета перед его установкой.

![Пример диалогового окна предварительного просмотра](media/InstallPreviewDialog.png)

<!-- This is here because the link in the UI needs this anchor. See https://github.com/NuGet/NuGet.Client/blob/dev/src/NuGet.Clients/PackageManagement.UI/Xamls/OptionsControl.xaml -->
<a name="install-options"></a>

### <a name="install-and-update-options"></a>Параметры установки и обновления

(доступно не для всех типов проектов)

**Поведение зависимости** — указывает способ определения устанавливаемых версий зависимых пакетов в NuGet.

- *Игнорировать зависимости* — пропускает установку зависимостей, что обычно приводит к прерыванию установки пакета.
- *Наименьший* [по умолчанию] — устанавливает зависимость с минимальным номером версии, соответствующим требованиям основного выбранного пакета.
- *Наибольший номер исправления* — устанавливает версию с теми же основными и дополнительными номерами версий, но с самым большим номером исправления. Например, если указана версия 1.2.2, будет установлена самая высокая версия, которая начинается с 1.2.
- *Наибольший номер дополнительной версии* — устанавливает версию с тем же основным номером версии, но с самым большим номером дополнительной версии и номером исправления. Если указана версия 1.2.2, будет установлена самая высокая версия, которая начинается с 1.
- *Наибольший* — устанавливает самую высокую доступную версию пакета.

**Действие при конфликте файлов** — указывает, как в NuGet должны обрабатываться пакеты, которые уже существуют в проекте или на локальном компьютере.

- *По приглашению* — NuGet спрашивает, следует ли сохранять или перезаписывать существующие пакеты.
- *Пропустить все* — NuGet пропускает перезапись существующих пакетов.
- *Перезаписать все* — NuGet перезаписывает существующие пакеты.

<!-- This is here because the link in the UI needs this anchor. See https://github.com/NuGet/NuGet.Client/blob/dev/src/NuGet.Clients/PackageManagement.UI/Xamls/OptionsControl.xaml -->
<a name="uninstall-options"></a>

### <a name="uninstall-options"></a>Параметры удаления

(доступно не для всех типов проектов)

**Удалить зависимости** — удаляются все зависимые пакеты, если на них нет ссылок в других местах проекта.

**Принудительно удалить, даже если есть зависимости от него** — пакет удаляется, даже если на него по-прежнему есть ссылка в проекте. Обычно используется в сочетании с **удалением зависимостей** для удаления пакета и любых установленных зависимостей. Но использование этого параметра может привести к нарушению ссылок в проекте. В таких случаях может потребоваться [переустановить другие пакеты](../consume-packages/reinstalling-and-updating-packages.md).
