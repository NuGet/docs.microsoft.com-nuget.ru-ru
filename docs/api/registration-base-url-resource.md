---
title: Метаданные пакета, API NuGet
description: Базовый URL-адрес регистрации пакета позволяет получать метаданные о пакетах.
author: joelverhagen
ms.author: jver
ms.date: 10/26/2017
ms.topic: reference
ms.reviewer: kraigb
ms.openlocfilehash: 403686de42bf4dc1fa94b9dd92ca6d33f3be2183
ms.sourcegitcommit: ee6c3f203648a5561c809db54ebeb1d0f0598b68
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/26/2021
ms.locfileid: "98775289"
---
# <a name="package-metadata"></a>Метаданные пакета

Можно получить метаданные о пакетах, доступных в источнике пакета, с помощью API NuGet v3. Эти метаданные можно получить с помощью ресурса, `RegistrationsBaseUrl` найденного в [индексе службы](service-index.md).

Коллекция документов, найденных в `RegistrationsBaseUrl` , часто называется регистрацией или BLOB-объектами регистрации. Набор документов под одним `RegistrationsBaseUrl` именем называется «регистрационный куст». Куст регистрации содержит все метаданные о каждом пакете, доступном в источнике пакета.

## <a name="versioning"></a>Управление версиями

Используются следующие `@type` значения:

Значение @type                     | Примечания
------------------------------- | -----
регистратионсбасеурл            | Первоначальный выпуск
Регистратионсбасеурл/3.0.0 — бета-версия | Псевдоним `RegistrationsBaseUrl`
Регистратионсбасеурл/3.0.0-RC   | Псевдоним `RegistrationsBaseUrl`
Регистратионсбасеурл/3.4.0      | Со сжатием gzip ответы
Регистратионсбасеурл/3.6.0      | Включает пакеты 2.0.0 SemVer

Он представляет три отдельных куста регистрации, доступных для различных версий клиента.

### <a name="registrationsbaseurl"></a>регистратионсбасеурл

Эти регистрации не сжимаются (то есть они используют подразумеваемые `Content-Encoding: identity` ). Пакеты 2.0.0 SemVer **исключаются** из этого Hive.

### <a name="registrationsbaseurl340"></a>Регистратионсбасеурл/3.4.0

Эти регистрации сжимаются с помощью `Content-Encoding: gzip` . Пакеты 2.0.0 SemVer **исключаются** из этого Hive.

### <a name="registrationsbaseurl360"></a>Регистратионсбасеурл/3.6.0

Эти регистрации сжимаются с помощью `Content-Encoding: gzip` . Пакеты 2.0.0 SemVer **включены** в этот куст.
Дополнительные сведения о SemVer 2.0.0 см. в разделе [Поддержка SemVer 2.0.0 для NuGet.org](https://github.com/NuGet/Home/wiki/SemVer2-support-for-nuget.org-%28server-side%29).

## <a name="base-url"></a>Базовый URL-адрес

Базовый URL-адрес для следующих API-интерфейсов — это значение `@id` свойства, связанного с вышеупомянутыми `@type` значениями ресурсов. В следующем документе будет использоваться базовый URL-адрес заполнителя `{@id}` .

## <a name="http-methods"></a>Методы HTTP

Все URL-адреса, найденные в ресурсе регистрации, поддерживают методы HTTP `GET` и `HEAD` .

## <a name="registration-index"></a>Индекс регистрации

Ресурс регистрации группирует метаданные пакета по ИДЕНТИФИКАТОРу пакета. Невозможно одновременно получить данные о нескольких ИДЕНТИФИКАТОРах пакетов. Этот ресурс не предоставляет способа обнаружения идентификаторов пакетов. Вместо этого предполагается, что клиент уже знает идентификатор нужного пакета. Доступные метаданные о каждой версии пакета зависят от реализации сервера. Большие двоичные объекты регистрации пакета имеют следующую иерархическую структуру:

- **Index**: точка входа для метаданных пакета, совместно используемая всеми пакетами в источнике с тем же идентификатором пакета.
- **Страница**: группирование версий пакета. Число версий пакета на странице определяется реализацией сервера.
- **Лист**: документ, относящийся к одной версии пакета.

URL-адрес индекса регистрации предсказуем и может быть определен клиентом по заданному ИДЕНТИФИКАТОРу пакета и `@id` значению ресурса регистрации из индекса службы. URL-адреса для страниц регистрации и листья обнаруживаются путем проверки индекса регистрации.

### <a name="registration-pages-and-leaves"></a>Страницы регистрации и листья

Хотя Серверная реализация для хранения листья регистрации в отдельных документах страниц регистрации не является обязательной, рекомендуется сохранить память на стороне клиента. Вместо встраивания всех элементов регистрации в индекс или немедленного хранения ненужных данных в документах страницы рекомендуется, чтобы Серверная реализация определяла некоторую эвристику, чтобы выбрать один из двух подходов в зависимости от числа версий пакета или совокупного размера выходов пакета.

Хранение всех версий пакета (листья) в индексе регистрации экономит количество HTTP-запросов, необходимых для получения метаданных пакета, но означает, что необходимо загрузить больший документ и выделить больше памяти клиента. С другой стороны, если реализация сервера сразу же сохраняет данные о выходе из отдельных страниц, клиент должен выполнить больше HTTP-запросов для получения необходимых сведений.

Эвристика, используемая nuget.org, выглядит следующим образом: если имеется 128 или более версий пакета, разбейте их на страницы размером 64. Если число версий меньше 128, все строки остаются в индексе регистрации. Обратите внимание, что это означает, что пакеты с 65 по 127 будут содержать две страницы в индексе, но обе страницы будут встроенными.

```
GET {@id}/{LOWER_ID}/index.json
```

### <a name="request-parameters"></a>Параметры запроса

Имя     | В     | Тип    | Обязательно | Примечания
-------- | ------ | ------- | -------- | -----
LOWER_ID | URL-адрес    | строка  | yes      | Идентификатор пакета, в нижнем регистре

`LOWER_ID`Значение представляет собой требуемый идентификатор пакета в нижнем регистре, используя правила, реализованные. Метод NET [`System.String.ToLowerInvariant()`](/dotnet/api/system.string.tolowerinvariant?view=netstandard-2.0#System_String_ToLowerInvariant&preserve-view=true) .

### <a name="response"></a>Ответ

Ответ — это документ JSON с корневым объектом со следующими свойствами:

Имя  | Тип             | Обязательно | Примечания
----- | ---------------- | -------- | -----
count | Целое число          | yes      | Число страниц регистрации в индексе
items | массив объектов | yes      | Массив страниц регистрации

Каждый элемент в массиве объекта индекса `items` является объектом JSON, представляющим страницу регистрации.

#### <a name="registration-page-object"></a>Объект страницы регистрации

Объект страницы регистрации, найденный в индексе регистрации, имеет следующие свойства:

Имя   | Тип             | Обязательно | Примечания
------ | ---------------- | -------- | -----
@id    | строка           | yes      | URL-адрес страницы регистрации
count  | Целое число          | yes      | Число конечных элементов регистрации на странице
items  | массив объектов | нет       | Массив конечных элементов регистрации и их связанные метаданные
lower  | строка           | yes      | Самая низкая версия SemVer 2.0.0 на странице (включающая)
родитель | строка           | нет       | URL-адрес индекса регистрации
upper  | строка           | yes      | Самая высокая версия SemVer 2.0.0 на странице (включающая)

`lower`И `upper` границы объекта Page полезны, если требуются метаданные для конкретной версии страницы.
Эти границы можно использовать для выборки только необходимой страницы регистрации. Строки версии соответствуют [правилам версий NuGet](../concepts/package-versioning.md). Строки версии нормализованы и не включают метаданные сборки. Как и в случае со всеми версиями в экосистеме NuGet, сравнение строк версии реализуется с помощью [правил очередности версий SemVer 2.0.0](https://semver.org/spec/v2.0.0.html#spec-item-11).

`parent`Свойство будет отображаться только в том случае, если объект страницы регистрации имеет `items` свойство.

Если `items` свойство отсутствует в объекте страницы регистрации, URL-адрес, указанный в параметре, `@id` должен использоваться для выборки метаданных по отдельным версиям пакета. `items`Массив иногда исключается из объекта Page в качестве оптимизации. Если количество версий одного пакета слишком велико, документ индекса регистрации будет очень большим и непроизводительна обрабатываться для клиента, который заботится о конкретной версии или небольшом диапазоне версий.

Обратите внимание, что если `items` свойство существует, `@id` свойство не требуется использовать, так как все данные страницы уже встроены в `items` свойство.

Каждый элемент в массиве объекта страницы `items` является объектом JSON, представляющим конечный лист регистрации и связанными с ним метаданными.

#### <a name="registration-leaf-object-in-a-page"></a>Конечный объект регистрации на странице

Конечный объект регистрации, найденный на странице регистрации, имеет следующие свойства:

Имя           | Тип   | Обязательно | Примечания
-------------- | ------ | -------- | -----
@id            | строка | yes      | URL-адрес конечного листа регистрации
каталожентри   | object | yes      | Запись каталога, содержащая метаданные пакета
паккажеконтент | строка | yes      | URL-адрес содержимого пакета (. nupkg)

Каждый конечный объект регистрации представляет данные, связанные с одной версией пакета.

#### <a name="catalog-entry"></a>Запись каталога

`catalogEntry`Свойство в конечном объекте регистрации имеет следующие свойства:

Имя                     | Тип                       | Обязательно | Примечания
------------------------ | -------------------------- | -------- | -----
@id                      | строка                     | yes      | URL-адрес документа, используемого для создания этого объекта
authors                  | строка или массив строк | нет       | 
депенденциграупс         | массив объектов           | нет       | Зависимости пакета, сгруппированные по целевым платформам
Deprecation              | object                     | нет       | Устаревшее значение, связанное с пакетом
description              | строка                     | нет       | 
iconUrl                  | строка                     | нет       | 
идентификатор                       | строка                     | yes      | Идентификатор пакета
licenseUrl               | строка                     | нет       |
лиценсикспрессион        | строка                     | нет       | 
перечисленные                   | Логическое                    | нет       | Следует рассматривать как перечисленное, если отсутствует
minClientVersion         | строка                     | нет       | 
projectUrl               | строка                     | нет       | 
published                | строка                     | нет       | Строка, содержащая метку времени ISO 8601, когда пакет был опубликован
requireLicenseAcceptance | Логическое                    | нет       | 
Итоги                  | строка                     | нет       | 
tags                     | строка или массив строк  | нет       | 
title                    | строка                     | нет       | 
version                  | строка                     | yes      | Строка полной версии после нормализации

Свойство package `version` представляет собой строку полной версии после нормализации. Это означает, что здесь можно добавить данные о сборке SemVer 2.0.0.

`dependencyGroups`Свойство представляет собой массив объектов, представляющих зависимости пакета, сгруппированные по целевой платформе. Если пакет не имеет зависимостей, `dependencyGroups` свойство отсутствует, пустой массив или `dependencies` свойство всех групп пусто или отсутствует.

Значение `licenseExpression` свойства соответствует [синтаксису выражения лицензии NuGet](../reference/nuspec.md#license).

> [!Note]
> В nuget.org `published` значение устанавливается равным year 1900, когда пакет удаляется из списка.

#### <a name="package-dependency-group"></a>Группа зависимостей пакета

Каждый объект группы зависимостей имеет следующие свойства:

Имя            | Тип             | Обязательно | Примечания
--------------- | ---------------- | -------- | -----
targetFramework | строка           | нет       | Целевая платформа, к которой применяются эти зависимости
зависимости    | массив объектов | нет       |

В `targetFramework` строке используется формат, реализованный с помощью NuGet в библиотеке .NET для NuGet [. Frameworks](https://www.nuget.org/packages/NuGet.Frameworks/). Если параметр не `targetFramework` указан, Группа зависимостей применяется ко всем целевым платформам.

`dependencies`Свойство представляет собой массив объектов, каждый из которых представляет зависимость пакета текущего пакета.

#### <a name="package-dependency"></a>Зависимость пакета

Каждая зависимость пакета имеет следующие свойства.

Имя         | Тип   | Обязательно | Примечания
------------ | ------ | -------- | -----
идентификатор           | строка | yes      | Идентификатор зависимости пакета
range        | object | нет       | Допустимый [диапазон версий](../concepts/package-versioning.md#version-ranges) зависимости
регистрация | строка | нет       | URL-адрес индекса регистрации для этой зависимости

Если `range` свойство исключено или является пустой строкой, клиент должен по умолчанию указать диапазон версий `(, )` . То есть разрешена любая версия зависимости. Значение не `*` допускается для `range` Свойства.

#### <a name="package-deprecation"></a>Объявление пакетов нерекомендуемыми

Все устаревшие пакеты имеют следующие свойства.

Имя             | Тип             | Обязательно | Примечания
---------------- | ---------------- | -------- | -----
ниже          | Массив строк | yes      | Причины, по которым пакет был признан устаревшим
message          | строка           | нет       | Дополнительные сведения об этой нерекомендуемости
алтернатепаккаже | object           | нет       | Вместо этого следует использовать альтернативный пакет

`reasons`Свойство должно содержать по меньшей мере одну строку и содержать только строки из следующей таблицы:

Причина       | Описание             
------------ | -----------
Прежняя версия       | Пакет больше не поддерживается
критикалбугс | Пакет содержит ошибки, которые делают его непригодным для использования
Другое        | Пакет устарел из-за причины, не включенной в этот список

Если `reasons` свойство содержит строки, которые не относятся к известному набору, их следует игнорировать. Строки не учитывают регистр, поэтому `legacy` должны обрабатываться так же, как `Legacy` . Ограничение упорядочения для массива отсутствует, поэтому строки могут быть упорядочены в любом произвольном порядке. Кроме того, если свойство содержит только строки, которые не относятся к известному набору, то она должна рассматриваться так, как если бы она содержала только строку «other».

#### <a name="alternate-package"></a>Альтернативный пакет

Альтернативный объект пакета имеет следующие свойства:

Имя         | Тип   | Обязательно | Примечания
------------ | ------ | -------- | -----
идентификатор           | строка | yes      | ИДЕНТИФИКАТОР альтернативного пакета
range        | object | нет       | Допустимый [диапазон версий](../concepts/package-versioning.md#version-ranges)или, `*` Если разрешена любая версия

### <a name="sample-request"></a>Пример запроса

```
GET https://api.nuget.org/v3/registration3/nuget.server.core/index.json
```

### <a name="sample-response"></a>Пример ответа

[!code-JSON [package-registration-index.json](./_data/package-registration-index.json)]

В этом конкретном случае индекс регистрации содержит встроенную страницу регистрации, поэтому дополнительные запросы на получение метаданных о конкретных версиях пакетов не требуются.

## <a name="registration-page"></a>Страница регистрации

На странице регистрации имеются листья регистрации. URL-адрес для выборки страницы регистрации определяется `@id` свойством в [объекте страницы регистрации](#registration-page-object) , упомянутом выше. Этот URL-адрес не является прогнозируемым и всегда должен обнаруживаться с помощью документа индекса.

> [!Warning]
> В nuget.org URL-адрес документа страницы регистрации содержал нижнюю и верхнюю границы страницы. Однако это предположение никогда не должно делаться клиентом, поскольку серверные реализации могут изменять форму URL-адреса, если в документе индекса есть действительная ссылка.

Если `items` массив не указан в индексе регистрации, HTTP-запрос Get `@id` значения вернет документ JSON с объектом в качестве корневого объекта. Ниже приводится описание свойств объекта.

Имя   | Тип             | Обязательно | Примечания
------ | ---------------- | -------- | -----
@id    | строка           | yes      | URL-адрес страницы регистрации
count  | Целое число          | yes      | Число конечных элементов регистрации на странице
items  | массив объектов | yes      | Массив конечных элементов регистрации и их связанные метаданные
lower  | строка           | yes      | Самая низкая версия SemVer 2.0.0 на странице (включающая)
родитель | строка           | yes      | URL-адрес индекса регистрации
upper  | строка           | yes      | Самая высокая версия SemVer 2.0.0 на странице (включающая)

Форма конечных объектов регистрации аналогична форме индекса регистрации [выше](#registration-leaf-object-in-a-page).

## <a name="sample-request"></a>Пример запроса

```
GET https://api.nuget.org/v3/registration3/ravendb.client/page/1.0.531/1.0.729-unstable.json
```

## <a name="sample-response"></a>Пример ответа

[!code-JSON [package-registration-page.json](./_data/package-registration-page.json)]

## <a name="registration-leaf"></a>Конечный лист регистрации

Конечный лист регистрации содержит сведения о конкретном ИДЕНТИФИКАТОРе и версии пакета. Метаданные определенной версии могут быть недоступны в этом документе. Метаданные пакета должны быть получены из [индекса регистрации](#registration-index) или со [страницы регистрации](#registration-page) (которая обнаруживается с помощью индекса регистрации).

URL-адрес для получения конечного листа регистрации получается из `@id` Свойства конечного объекта регистрации в индексе регистрации или на странице регистрации. Как и в случае страницы документа. Этот URL-адрес не является прогнозируемым и всегда должен обнаруживаться с помощью объекта страницы регистрации.

> [!Warning]
> В nuget.org URL-адрес конечного документа регистрации содержит версию пакета. Однако это предположение никогда не должно делаться клиентом, поскольку серверные реализации могут изменять форму URL-адреса, если родительский документ имеет действительную ссылку. 

Конечный лист регистрации — это документ JSON с корневым объектом со следующими свойствами:

Имя           | Тип    | Обязательно | Примечания
-------------- | ------- | -------- | -----
@id            | строка  | yes      | URL-адрес конечного листа регистрации
каталожентри   | строка  | нет       | URL-адрес записи каталога, которая создала эти конечные
перечисленные         | Логическое | нет       | Следует рассматривать как перечисленное, если отсутствует
паккажеконтент | строка  | нет       | URL-адрес содержимого пакета (. nupkg)
published      | строка  | нет       | Строка, содержащая метку времени ISO 8601, когда пакет был опубликован
регистрация   | строка  | нет       | URL-адрес индекса регистрации

> [!Note]
> В nuget.org `published` значение устанавливается равным year 1900, когда пакет удаляется из списка.

### <a name="sample-request"></a>Пример запроса

```
GET https://api.nuget.org/v3/registration3/nuget.versioning/4.3.0.json
```

### <a name="sample-response"></a>Пример ответа

[!code-JSON [package-registration-leaf.json](./_data/package-registration-leaf.json)]
