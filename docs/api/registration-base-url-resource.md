---
title: Метаданные пакета, API NuGet
description: Базовый URL-адрес регистрации пакета позволяет получать метаданные о пакетах.
author: joelverhagen
ms.author: jver
ms.date: 10/26/2017
ms.topic: reference
ms.reviewer: kraigb
ms.openlocfilehash: eb8d59e253f85fbbb8546a5f71856df842ce94d6
ms.sourcegitcommit: 60414a17af65237652c1de9926475a74856b91cc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/14/2019
ms.locfileid: "74096888"
---
# <a name="package-metadata"></a>Метаданные пакета

Можно получить метаданные о пакетах, доступных в источнике пакета, с помощью API NuGet v3. Эти метаданные можно получить с помощью ресурса `RegistrationsBaseUrl`, найденного в [индексе службы](service-index.md).

Коллекция документов, найденных в `RegistrationsBaseUrl`, часто называется регистрацией или BLOB-объектами регистрации. Набор документов в одном `RegistrationsBaseUrl` называется "регистрационный куст". Куст регистрации содержит все метаданные о каждом пакете, доступном в источнике пакета.

## <a name="versioning"></a>Управление версиями

Используются следующие `@type` значения:

Значение@type                     | Примечания
------------------------------- | -----
регистратионсбасеурл            | Первоначальный выпуск
Регистратионсбасеурл/3.0.0 — бета-версия | Псевдоним `RegistrationsBaseUrl`
Регистратионсбасеурл/3.0.0-RC   | Псевдоним `RegistrationsBaseUrl`
Регистратионсбасеурл/3.4.0      | Со сжатием gzip ответы
Регистратионсбасеурл/3.6.0      | Включает пакеты 2.0.0 SemVer

Он представляет три отдельных куста регистрации, доступных для различных версий клиента.

### <a name="registrationsbaseurl"></a>регистратионсбасеурл

Эти регистрации не сжимаются (это означает, что они используют подразумеваемый `Content-Encoding: identity`). Пакеты 2.0.0 SemVer **исключаются** из этого Hive.

### <a name="registrationsbaseurl340"></a>Регистратионсбасеурл/3.4.0

Эти регистрации сжимаются с помощью `Content-Encoding: gzip`. Пакеты 2.0.0 SemVer **исключаются** из этого Hive.

### <a name="registrationsbaseurl360"></a>Регистратионсбасеурл/3.6.0

Эти регистрации сжимаются с помощью `Content-Encoding: gzip`. Пакеты 2.0.0 SemVer **включены** в этот куст.
Дополнительные сведения о SemVer 2.0.0 см. в разделе [Поддержка SemVer 2.0.0 для NuGet.org](https://github.com/NuGet/Home/wiki/SemVer2-support-for-nuget.org-%28server-side%29).

## <a name="base-url"></a>Базовый URL-адрес

Базовый URL-адрес для следующих API-интерфейсов — это значение свойства `@id`, связанного с вышеупомянутым ресурсом `@type` значений. В следующем документе будет использоваться базовый URL-адрес заполнителя `{@id}`.

## <a name="http-methods"></a>Методы HTTP

Все URL-адреса, найденные в ресурсе регистрации, поддерживают методы HTTP `GET` и `HEAD`.

## <a name="registration-index"></a>Индекс регистрации

Ресурс регистрации группирует метаданные пакета по ИДЕНТИФИКАТОРу пакета. Невозможно одновременно получить данные о нескольких ИДЕНТИФИКАТОРах пакетов. Этот ресурс не предоставляет способа обнаружения идентификаторов пакетов. Вместо этого предполагается, что клиент уже знает идентификатор нужного пакета. Доступные метаданные о каждой версии пакета зависят от реализации сервера. Большие двоичные объекты регистрации пакета имеют следующую иерархическую структуру:

- **Index**: точка входа для метаданных пакета, совместно используемая всеми пакетами в источнике с тем же идентификатором пакета.
- **Страница**: группирование версий пакета. Число версий пакета на странице определяется реализацией сервера.
- **Лист**: документ, относящийся к одной версии пакета.

URL-адрес индекса регистрации предсказуем и может быть определен клиентом по заданному ИДЕНТИФИКАТОРу пакета и `@id`ному значению ресурса регистрации из индекса службы. URL-адреса для страниц регистрации и листья обнаруживаются путем проверки индекса регистрации.

### <a name="registration-pages-and-leaves"></a>Страницы регистрации и листья

Хотя Серверная реализация для хранения листья регистрации в отдельных документах страниц регистрации не является обязательной, рекомендуется сохранить память на стороне клиента. Вместо встраивания всех элементов регистрации в индекс или немедленного хранения в документах страниц рекомендуется, чтобы Серверная реализация определяла некоторую эвристику, чтобы выбрать один из двух подходов в зависимости от числа версий пакета или Совокупный размер листья пакета.

Хранение всех версий пакета (листья) в индексе регистрации экономит количество HTTP-запросов, необходимых для получения метаданных пакета, но означает, что необходимо загрузить больший документ и выделить больше памяти клиента. С другой стороны, если реализация сервера сразу же сохраняет данные о выходе из отдельных страниц, клиент должен выполнить больше HTTP-запросов для получения необходимых сведений.

Эвристика, используемая nuget.org, выглядит следующим образом: если имеется 128 или более версий пакета, разбейте их на страницы размером 64. Если число версий меньше 128, все строки остаются в индексе регистрации. Обратите внимание, что это означает, что пакеты с 65 по 127 будут содержать две страницы в индексе, но обе страницы будут встроенными.

    GET {@id}/{LOWER_ID}/index.json

### <a name="request-parameters"></a>Параметры запроса

Название     | Увеличение     | Type    | Обязательное значение | Примечания
-------- | ------ | ------- | -------- | -----
LOWER_ID | URL-адрес    | string  | да      | Идентификатор пакета, в нижнем регистре

Значение `LOWER_ID` — это идентификатор нужного пакета в нижнем регистре, использующий правила, реализованные. Метод [`System.String.ToLowerInvariant()`](/dotnet/api/system.string.tolowerinvariant?view=netstandard-2.0#System_String_ToLowerInvariant) сети.

### <a name="response"></a>Ответ

Ответ — это документ JSON с корневым объектом со следующими свойствами:

Название  | Type             | Обязательное значение | Примечания
----- | ---------------- | -------- | -----
количество | целочисленный          | да      | Число страниц регистрации в индексе
items | Массив объектов | да      | Массив страниц регистрации

Каждый элемент в массиве `items` объекта индекса является объектом JSON, представляющим страницу регистрации.

#### <a name="registration-page-object"></a>Объект страницы регистрации

Объект страницы регистрации, найденный в индексе регистрации, имеет следующие свойства:

Название   | Type             | Обязательное значение | Примечания
------ | ---------------- | -------- | -----
@id    | string           | да      | URL-адрес страницы регистрации
количество  | целочисленный          | да      | Число конечных элементов регистрации на странице
items  | Массив объектов | нет       | Массив конечных элементов регистрации и их связанные метаданные
сокращение  | string           | да      | Самая низкая версия SemVer 2.0.0 на странице (включающая)
parent | string           | нет       | URL-адрес индекса регистрации
границ  | string           | да      | Самая высокая версия SemVer 2.0.0 на странице (включающая)

Границы `lower` и `upper` объекта Page полезны, если требуются метаданные для конкретной версии страницы.
Эти границы можно использовать для выборки только необходимой страницы регистрации. Строки версии соответствуют [правилам версий NuGet](../concepts/package-versioning.md). Строки версии нормализованы и не включают метаданные сборки. Как и в случае со всеми версиями в экосистеме NuGet, сравнение строк версии реализуется с помощью [правил очередности версий SemVer 2.0.0](https://semver.org/spec/v2.0.0.html#spec-item-11).

Свойство `parent` будет отображаться только в том случае, если объект страницы регистрации имеет свойство `items`.

Если свойство `items` отсутствует в объекте страницы регистрации, URL-адрес, указанный в `@id`, должен использоваться для выборки метаданных по отдельным версиям пакета. `items` массив иногда исключается из объекта Page в качестве оптимизации. Если количество версий одного пакета слишком велико, документ индекса регистрации будет очень большим и непроизводительна обрабатываться для клиента, который заботится о конкретной версии или небольшом диапазоне версий.

Обратите внимание, что если свойство `items` существует, свойство `@id` не требуется использовать, так как все данные страницы уже встроены в свойство `items`.

Каждый элемент в массиве `items` объекта страницы является объектом JSON, представляющим конечный лист регистрации и связанными с ним метаданными.

#### <a name="registration-leaf-object-in-a-page"></a>Конечный объект регистрации на странице

Конечный объект регистрации, найденный на странице регистрации, имеет следующие свойства:

Название           | Type   | Обязательное значение | Примечания
-------------- | ------ | -------- | -----
@id            | string | да      | URL-адрес конечного листа регистрации
каталожентри   | Объект | да      | Запись каталога, содержащая метаданные пакета
паккажеконтент | string | да      | URL-адрес содержимого пакета (. nupkg)

Каждый конечный объект регистрации представляет данные, связанные с одной версией пакета.

#### <a name="catalog-entry"></a>Запись каталога

Свойство `catalogEntry` в конечном объекте регистрации имеет следующие свойства.

Название                     | Type                       | Обязательное значение | Примечания
------------------------ | -------------------------- | -------- | -----
@id                      | string                     | да      | URL-адрес документа, используемого для создания этого объекта
authors                  | строка или массив строк | нет       | 
депенденциграупс         | Массив объектов           | нет       | Зависимости пакета, сгруппированные по целевым платформам
Deprecation              | Объект                     | нет       | Устаревшее значение, связанное с пакетом
описание              | string                     | нет       | 
iconUrl                  | string                     | нет       | 
id                       | string                     | да      | Идентификатор пакета
licenseUrl               | string                     | нет       |
лиценсикспрессион        | string                     | нет       | 
перечисленные                   | boolean                    | нет       | Следует рассматривать как перечисленное, если отсутствует
minClientVersion         | string                     | нет       | 
projectUrl               | string                     | нет       | 
выпущен                | string                     | нет       | Строка, содержащая метку времени ISO 8601, когда пакет был опубликован
requireLicenseAcceptance | boolean                    | нет       | 
сводка                  | string                     | нет       | 
теги                     | строка или массив строк  | нет       | 
заголовок                    | string                     | нет       | 
version                  | string                     | да      | Строка полной версии после нормализации

Свойство `version` пакета — это полная строка версии после нормализации. Это означает, что здесь можно добавить данные о сборке SemVer 2.0.0.

Свойство `dependencyGroups` — это массив объектов, представляющий зависимости пакета, сгруппированные по целевой платформе. Если пакет не имеет зависимостей, свойство `dependencyGroups` отсутствует, пустой массив или свойство `dependencies` всех групп пусто или отсутствует.

Значение свойства `licenseExpression` соответствует [синтаксису выражения лицензии NuGet](https://docs.microsoft.com/nuget/reference/nuspec#license).

> [!Note]
> В nuget.org значение `published` устанавливается равным year 1900, когда пакет удаляется из списка.

#### <a name="package-dependency-group"></a>Группа зависимостей пакета

Каждый объект группы зависимостей имеет следующие свойства:

Название            | Type             | Обязательное значение | Примечания
--------------- | ---------------- | -------- | -----
targetFramework | string           | нет       | Целевая платформа, к которой применяются эти зависимости
зависимости    | Массив объектов | нет       |

В `targetFramework`ной строке используется формат, реализованный в NuGet библиотеки .NET для NuGet [. Frameworks](https://www.nuget.org/packages/NuGet.Frameworks/). Если `targetFramework` не указано, Группа зависимостей применяется ко всем целевым платформам.

Свойство `dependencies` — это массив объектов, каждый из которых представляет зависимость пакета текущего пакета.

#### <a name="package-dependency"></a>Зависимость пакета

Каждая зависимость пакета имеет следующие свойства.

Название         | Type   | Обязательное значение | Примечания
------------ | ------ | -------- | -----
id           | string | да      | Идентификатор зависимости пакета
range        | Объект | нет       | Допустимый [диапазон версий](../concepts/package-versioning.md#version-ranges-and-wildcards) зависимости
регистрация | string | нет       | URL-адрес индекса регистрации для этой зависимости

Если свойство `range` исключено или является пустой строкой, клиент должен по умолчанию указать диапазон версий `(, )`. То есть разрешена любая версия зависимости. Значение `*` не разрешено для свойства `range`.

#### <a name="package-deprecation"></a>Устаревшие пакеты

Все устаревшие пакеты имеют следующие свойства.

Название             | Type             | Обязательное значение | Примечания
---------------- | ---------------- | -------- | -----
ниже          | Массив строк | да      | Причины, по которым пакет был признан устаревшим
сообщение          | string           | нет       | Дополнительные сведения об этой нерекомендуемости
алтернатепаккаже | Объект           | нет       | Вместо этого следует использовать альтернативный пакет

Свойство `reasons` должно содержать по крайней мере одну строку, и в ней должны содержаться только строки из следующей таблицы:

Причина       | Описание             
------------ | -----------
Прежние версии       | Пакет больше не поддерживается
критикалбугс | Пакет содержит ошибки, которые делают его непригодным для использования
Другой        | Пакет устарел из-за причины, не включенной в этот список

Если свойство `reasons` содержит строки, которые не относятся к известному набору, их следует игнорировать. Строки не чувствительны к регистру, поэтому `legacy` должны обрабатываться так же, как `Legacy`. Ограничение упорядочения для массива отсутствует, поэтому строки могут быть упорядочены в любом произвольном порядке. Кроме того, если свойство содержит только строки, которые не относятся к известному набору, то она должна рассматриваться так, как если бы она содержала только строку «other».

#### <a name="alternate-package"></a>Альтернативный пакет

Альтернативный объект пакета имеет следующие свойства:

Название         | Type   | Обязательное значение | Примечания
------------ | ------ | -------- | -----
id           | string | да      | ИДЕНТИФИКАТОР альтернативного пакета
range        | Объект | нет       | Допустимый [диапазон версий](../concepts/package-versioning.md#version-ranges-and-wildcards)или `*`, если разрешена любая версия
регистрация | string | нет       | URL-адрес индекса регистрации для этого альтернативного пакета

### <a name="sample-request"></a>Пример запроса

    GET https://api.nuget.org/v3/registration3/nuget.server.core/index.json

### <a name="sample-response"></a>Пример ответа

[!code-JSON [package-registration-index.json](./_data/package-registration-index.json)]

В этом конкретном случае индекс регистрации содержит встроенную страницу регистрации, поэтому дополнительные запросы на получение метаданных о конкретных версиях пакетов не требуются.

## <a name="registration-page"></a>Страница регистрации

На странице регистрации имеются листья регистрации. URL-адрес для выборки страницы регистрации определяется свойством `@id` в [объекте страницы регистрации](#registration-page-object) , упомянутом выше. Этот URL-адрес не является прогнозируемым и всегда должен обнаруживаться с помощью документа индекса.

> [!Warning]
> В nuget.org URL-адрес документа страницы регистрации содержал нижнюю и верхнюю границы страницы. Однако это предположение никогда не должно делаться клиентом, поскольку серверные реализации могут изменять форму URL-адреса, если в документе индекса есть действительная ссылка.

Если массив `items` не указан в индексе регистрации, HTTP-запрос GET значения `@id` вернет документ JSON с объектом в качестве корневого элемента. Объект имеет следующие свойства:

Название   | Type             | Обязательное значение | Примечания
------ | ---------------- | -------- | -----
@id    | string           | да      | URL-адрес страницы регистрации
количество  | целочисленный          | да      | Число конечных элементов регистрации на странице
items  | Массив объектов | да      | Массив конечных элементов регистрации и их связанные метаданные
сокращение  | string           | да      | Самая низкая версия SemVer 2.0.0 на странице (включающая)
parent | string           | да      | URL-адрес индекса регистрации
границ  | string           | да      | Самая высокая версия SemVer 2.0.0 на странице (включающая)

Форма конечных объектов регистрации аналогична форме индекса регистрации [выше](#registration-leaf-object-in-a-page).

## <a name="sample-request"></a>Пример запроса

    GET https://api.nuget.org/v3/registration3/ravendb.client/page/1.0.531/1.0.729-unstable.json

## <a name="sample-response"></a>Пример ответа

[!code-JSON [package-registration-page.json](./_data/package-registration-page.json)]

## <a name="registration-leaf"></a>Конечный лист регистрации

Конечный лист регистрации содержит сведения о конкретном ИДЕНТИФИКАТОРе и версии пакета. Метаданные определенной версии могут быть недоступны в этом документе. Метаданные пакета должны быть получены из [индекса регистрации](#registration-index) или со [страницы регистрации](#registration-page) (которая обнаруживается с помощью индекса регистрации).

URL-адрес для получения конечного листа регистрации получен из свойства `@id` конечного объекта регистрации в индексе регистрации или на странице регистрации. Как и в случае страницы документа. Этот URL-адрес не является прогнозируемым и всегда должен обнаруживаться с помощью объекта страницы регистрации.

> [!Warning]
> В nuget.org URL-адрес конечного документа регистрации содержит версию пакета. Однако это предположение никогда не должно делаться клиентом, поскольку серверные реализации могут изменять форму URL-адреса, если родительский документ имеет действительную ссылку. 

Конечный лист регистрации — это документ JSON с корневым объектом со следующими свойствами:

Название           | Type    | Обязательное значение | Примечания
-------------- | ------- | -------- | -----
@id            | string  | да      | URL-адрес конечного листа регистрации
каталожентри   | string  | нет       | URL-адрес записи каталога, которая создала эти конечные
перечисленные         | boolean | нет       | Следует рассматривать как перечисленное, если отсутствует
паккажеконтент | string  | нет       | URL-адрес содержимого пакета (. nupkg)
выпущен      | string  | нет       | Строка, содержащая метку времени ISO 8601, когда пакет был опубликован
регистрация   | string  | нет       | URL-адрес индекса регистрации

> [!Note]
> В nuget.org значение `published` устанавливается равным year 1900, когда пакет удаляется из списка.

### <a name="sample-request"></a>Пример запроса

    GET https://api.nuget.org/v3/registration3/nuget.versioning/4.3.0.json

### <a name="sample-response"></a>Пример ответа

[!code-JSON [package-registration-leaf.json](./_data/package-registration-leaf.json)]
