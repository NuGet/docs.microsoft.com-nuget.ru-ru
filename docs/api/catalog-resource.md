---
title: Ресурс каталога, API NuGet 3
description: Каталог — индекс всех пакетов создаются и удаляются на сайте nuget.org.
author: joelverhagen
ms.author: jver
ms.date: 10/30/2017
ms.topic: reference
ms.reviewer: kraigb
ms.openlocfilehash: 4884de71151ee1ae3c0a78b803c9222f9c1d86ec
ms.sourcegitcommit: ef08f376688f0191a8d3d873b6a4386afd799373
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/28/2019
ms.locfileid: "66266359"
---
# <a name="catalog"></a>Catalog

**Каталога** — это ресурс, в котором фиксируются все операции пакета источника пакета, например операции создания и удаления. У ресурса каталога `Catalog` введите [индекс службы](service-index.md). Можно использовать этот ресурс для [запроса все опубликованные пакеты](../guides/api/query-for-all-published-packages.md).

> [!Note]
> Так как каталог не используется официального клиента NuGet, не все источники пакетов реализовать каталога.

> [!Note]
> В настоящее время nuget.org каталог недоступен в Китае. Дополнительные сведения см. в разделе [NuGet/NuGetGallery#4949](https://github.com/NuGet/NuGetGallery/issues/4949).

## <a name="versioning"></a>Управление версиями

Следующие `@type` используется значение:

Значение@type    | Примечания
------------- | -----
CATALOG/3.0.0 | Первоначальный выпуск

## <a name="base-url"></a>Базовый URL-адрес

URL-адрес точки входа для следующих API-интерфейсов является значением `@id` свойство, связанное с ресурсом, упомянутых выше `@type` значения. В этом разделе используется заполнитель URL-адреса `{@id}`.

## <a name="http-methods"></a>Методы HTTP

Все URL-адресов в поддержка каталога ресурсов только методы HTTP `GET` и `HEAD`.

## <a name="catalog-index"></a>Индекс в каталоге

Индекс каталога является документом в хорошо известного расположения со списком элементов каталога, в хронологическом порядке. Это точка входа ресурса каталога.

Индекс состоит из страниц каталога. Каждая страница каталога содержит элементы каталога. Каждый элемент каталога представляет событие, касающиеся единый пакет на точку во времени. Элемент каталога может представлять пакета, который был создан, отсутствующие в списке, удалении или удаленных из источника пакета. Путем обработки элементов каталога в хронологическом порядке, клиент можно построить актуальное представление каждого пакета, который существует в источнике пакета V3.

Короче говоря каталог больших двоичных объектов характерна следующей иерархической структуре:

- **Индекс**: точка входа для каталога.
- **Страница**: группирование элементов каталога.
- **Конечный**: документ, представляющий элемент каталога, который представляет собой моментальный снимок состояния одного пакета.

Каждый объект каталога имеет свойство с именем `commitTimeStamp` представления при добавлении элемента в каталоге. Элементы каталога добавляются на страницу каталога в пакетах, называемых фиксациями. Все элементы каталога в той же фиксации имеют одну и ту же метку времени фиксации (`commitTimeStamp`) и идентификатор фиксации (`commitId`). Элементы каталога, размещенные в той же фиксации представляют событиях, произошедших вокруг тот же момент времени в источнике пакета. Нет, не порядок в пределах каталога фиксации.

Так как каждый ИД и версию пакета является уникальным, никогда не будет больше одного элемента каталога в фиксации. Это гарантирует, что элементы каталога для одного пакета можно всегда однозначно Упорядочить по отношению к меткой времени фиксации.

Нет никогда не будет более чем одну фиксацию в каталог за `commitTimeStamp`. Другими словами `commitId` является избыточной `commitTimeStamp`.

В отличие от к [ресурс метаданных пакета](registration-base-url-resource.md), которая индексируется по Идентификатору пакета, каталог индексированных (и поддерживает запросы) только по времени.

Элементы каталога всегда добавляются в каталог в монотонно возрастающей хронологическом порядке. Это означает, что если фиксация каталога добавляется на момент времени X затем сохранение каталога постоянно добавляется с временем меньше или равно X.

Следующий запрос извлекает индекс каталога.

    GET {@id}

Индекс каталога — это документ JSON, который содержит объект со следующими свойствами:

name            | Тип             | Обязательно | Примечания
--------------- | ---------------- | -------- | -----
commitId        | string           | да      | Уникальный идентификатор, связанный с последней фиксации
commitTimeStamp | string           | да      | Отметку времени последней фиксации
count           | целочисленный          | да      | Количество страниц в индексе
items           | Массив объектов | да      | Массив объектов, каждый объект, представляющий страницу

Каждый элемент `items` массив является объектом с некоторых минимальных сведений о каждой странице. Эти объекты не содержат конечных объектов каталога (элементы). Не определен порядок элементов в этом массиве. Страницы могут быть упорядочены клиентом в памяти с помощью их `commitTimeStamp` свойство.

Добавляются новые страницы, `count` увеличивается, и новые объекты будут отображаться в `items` массива.

При добавлении элементов каталога, индекс `commitId` приведет к изменению и `commitTimeStamp` увеличится. Эти свойства являются по сути сводные данные на странице "все" `commitId` и `commitTimeStamp` значения в `items` массива.

### <a name="catalog-page-object-in-the-index"></a>Объект страницы каталога в индексе

Объекты каталога страницы, включенные в индекс каталога `items` свойства имеют следующие свойства:

name            | Тип    | Обязательно | Примечания
--------------- | ------- | -------- | -----
@id             | string  | да      | URL-адрес страницы каталога выборки
commitId        | string  | да      | Уникальный идентификатор, связанный с последней фиксации на этой странице
commitTimeStamp | string  | да      | Отметку времени последней фиксации на этой странице
count           | целочисленный | да      | Количество элементов на странице каталога

В отличие от к [ресурс метаданных пакета](registration-base-url-resource.md) каких в некоторых случаях inlines оставляет в индекс, конечными объектами каталога никогда не подставляются в индекс и всегда должны получаться с помощью страницы `@id` URL-адрес.

### <a name="sample-request"></a>Пример запроса

    GET https://api.nuget.org/v3/catalog0/index.json

### <a name="sample-response"></a>Пример ответа

[!code-JSON [catalog-index.json](./_data/catalog-index.json)]

## <a name="catalog-page"></a>Страница каталога

На странице каталога — это совокупность элементов каталога. Это документ, получены с помощью одного из `@id` обнаружены значения в индексе каталога. URL-адрес страницы каталога не является прогнозируемым и должны быть обнаружены с помощью только индекс каталога.

Новые элементы каталога, добавляются на страницу в индексе каталога только с наивысшим меткой времени фиксации или на новую страницу. После добавления на страницу с более поздней версии меткой времени фиксации в каталог более старые страницы никогда не добавить или изменить.

Страница документа каталога представляет собой объект JSON со следующими свойствами:

name            | Тип             | Обязательно | Примечания
--------------- | ---------------- | -------- | -----
commitId        | string           | да      | Уникальный идентификатор, связанный с последней фиксации на этой странице
commitTimeStamp | string           | да      | Отметку времени последней фиксации на этой странице
count           | целочисленный          | да      | Количество элементов на странице
items           | Массив объектов | да      | Элементы каталога на этой странице
parent          | string           | да      | URL-адрес каталога

Каждый элемент `items` массив является объектом с некоторых минимальных сведений об элементе каталога. Эти объекты элементов не содержат все данные элемента каталога. Порядок элементов на странице `items` массива не определен. Элементы могут быть упорядочены по клиента в памяти с помощью их `commitTimeStamp` свойство.

Количество элементов каталога на странице определяется реализации сервера. Для nuget.org есть более 550 элементы на каждой странице, несмотря на то, что реальное количество может быть меньшего размера для некоторых страниц в зависимости от размера следующего фиксации пакета в точку во времени.

Добавляются новые элементы, `count` является объекты каталога увеличиваются и новый элемент, отображаются в `items` массива.

Так как элементы добавляются на страницу `commitId` изменений и `commitTimeStamp` увеличивается. Эти два свойства: по сути сводные данные по всем `commitId` и `commitTimeStamp` значения в `items` массива.

### <a name="catalog-item-object-in-a-page"></a>Объект элемента на странице каталога

Объекты элемента каталога, включенные на странице каталога `items` свойства имеют следующие свойства:

name            | Тип    | Обязательно | Примечания
--------------- | ------- | -------- | -----
@id             | string  | да      | URL-адрес щелчка элемента каталога
@type           | string  | да      | Тип элемента каталога
commitId        | string  | да      | ИД фиксации, связанный с этим элементом каталога
commitTimeStamp | string  | да      | Метка времени фиксации данного элемента каталога
NuGet:ID        | string  | да      | Идентификатор пакета, связанного с этой конечного
NuGet:Version   | string  | да      | Версия пакета, связанного с этой конечного

`@type` Значение будет иметь одно из следующих двух значений:

1. `nuget:PackageDetails`: это соответствует `PackageDetails` типа в документ конечного объекта каталога.
1. `nuget:PackageDelete`: это соответствует `PackageDelete` типа в документ конечного объекта каталога.

Дополнительные сведения о означает, что каждого типа, см. в разделе [соответствующих элементов типа](#item-types) ниже.

### <a name="sample-request"></a>Пример запроса

    GET https://api.nuget.org/v3/catalog0/page2926.json

### <a name="sample-response"></a>Пример ответа

[!code-JSON [catalog-page.json](./_data/catalog-page.json)]

## <a name="catalog-leaf"></a>Конечный каталог

Конечный каталог содержит метаданные о конкретных ИД и версию пакета в определенный момент времени. Это документ, извлечь с помощью `@id` значение найдено в каталоге страницы. URL-адрес конечного каталога не является прогнозируемым и должны быть обнаружены с помощью только страницы каталога.

Документ конечного объекта каталога представляет собой объект JSON со следующими свойствами:

name                    | Тип                       | Обязательно | Примечания
----------------------- | -------------------------- | -------- | -----
@type                   | Строка или массив строк | да      | Типы элемента каталога
каталог: commitId        | string                     | да      | ИД фиксации, связанный с этим элементом каталога
каталог: commitTimeStamp | string                     | да      | Метка времени фиксации данного элемента каталога
id                      | string                     | да      | Идентификатор пакета элемента каталога
Опубликованные               | string                     | да      | Дата публикации элемента каталога пакета
version                 | string                     | да      | Версия пакета элемента каталога

### <a name="item-types"></a>Типы элементов

`@type` Свойство — это строка или массив строк. Для удобства Если `@type` значение является строкой, его следует рассматривать как какой-либо массив одного размера. Не все возможные значения для `@type` документированы. Тем не менее каждый элемент каталога имеет только один из двух следующих строковых значений типа:

1. `PackageDetails`: представляет снимок метаданные пакета
1. `PackageDelete`: представляет пакет, который был удален

### <a name="package-details-catalog-items"></a>Сведения о пакете позиций каталога

Элементы с типом каталога `PackageDetails` содержат снимок метаданные пакета для определенного пакета (ИД и версию сочетание). Элемент каталога сведения пакет создается в том случае, если источник пакета обнаружит любой из следующих сценариев:

1. Пакет представляет собой **отправлена**.
1. Пакет представляет собой **перечисленных**.
1. Пакет представляет собой **отсутствующие в списке**.
1. Пакет представляет собой **перекомпоновки**.

Перекомпоновка пакета является административные жест, который по сути создает фальшивые принудительной передачи существующего пакета без изменения к самому пакету. На сайте nuget.org Перекомпоновка используется после исправления ошибки в одном из фоновых заданий, которые используют каталог.

Клиенты, использование элементов каталога не следует пытаться определить, какие из этих сценариев созданного элемента каталога. Вместо этого клиент должен просто обновить любой поддерживаемый представление или индекс с метаданными, содержащееся в элементе каталога. Кроме того, элементы каталога повторяющихся или избыточные должны корректно обрабатываться (идемпотентной).

Элементы каталога сведения о пакета имеют следующие свойства помимо тех [на всех конечных объектов каталога](#catalog-leaf).

name                    | Тип                       | Обязательно | Примечания
----------------------- | -------------------------- | -------- | -----
authors                 | string                     | Нет       |
created                 | string                     | Нет       | Отметка времени при первом создании пакета. Резервный свойство: `published`.
dependencyGroups        | Массив объектов           | Нет       | Такой же формат, как [ресурс метаданных пакета](registration-base-url-resource.md#package-dependency-group)
Описание             | string                     | Нет       |
iconUrl                 | string                     | Нет       |
isPrerelease            | boolean                    | Нет       | Ли версия пакета является предварительной версией. Могут быть обнаружены из `version`.
язык                | string                     | Нет       |
licenseUrl              | string                     | Нет       |
перечисленные                  | boolean                    | Нет       | Указан ли пакет
MinClientVersion        | string                     | Нет       |
packageHash             | string                     | да      | Хэш-код пакета, Сервис кодирования с использованием [стандартный base-64](https://tools.ietf.org/html/rfc4648#section-4)
packageHashAlgorithm    | string                     | да      |
размер груза             | целочисленный                    | да      | Размер файла nupkg пакета в байтах
projectUrl              | string                     | Нет       |
releaseNotes            | string                     | Нет       |
requireLicenseAgreement | boolean                    | Нет       | Предположим, `false` если исключено
сводка                 | string                     | Нет       |
теги                    | Массив строк           | Нет       |
заголовок                   | string                     | Нет       |
verbatimVersion         | string                     | Нет       | Строка версии, так как он изначально находится в файла nuspec

Пакет `version` свойство — это строка полной версии после нормализации. Это означает, что данные SemVer 2.0.0 сборки можно включить здесь.

`created` Метка времени — это, если пакет сначала получен от источника пакета, как правило, некоторое время перед меткой времени фиксации элемента каталога.

`packageHashAlgorithm` Представляет собой строку, определяемое реализацией сервера, представляющий алгоритм хэширования, используемый для создания `packageHash`. всегда используется NuGet.org `packageHashAlgorithm` значение `SHA512`.

`published` Метка времени представляет время, когда последнее перечисленного пакета.

> [!Note]
> На сайте nuget.org `published` имеет значение 1900 год, если пакет не включенных в список.

#### <a name="sample-request"></a>Пример запроса

ПОЛУЧИТЬ https://api.nuget.org/v3/catalog0/data/2015.02.01.11.18.40/windowsazure.storage.1.0.0.json

#### <a name="sample-response"></a>Пример ответа

[!code-JSON [catalog-package-details.json](./_data/catalog-package-details.json)]

### <a name="package-delete-catalog-items"></a>Элементы каталога пакета удаления

Элементы с типом каталога `PackageDelete` содержит минимальный набор сведениями, указывающими, для клиентов каталога, что пакет был удален из источника пакета и больше не доступен для любой операции пакета (например, восстановление).

> [!Note]
> Вполне возможно, для пакета для удаления и позже, повторно используя один идентификатор пакета и версии. На сайте nuget.org это очень редко так как это нарушает официальный клиент предположение, что идентификатор пакета и версия подразумевают содержимое пакета. Дополнительные сведения об удалении пакета на сайте nuget.org, см. в разделе [нашей политике](../policies/deleting-packages.md).

Элементы каталога удаления пакета не имеют дополнительных свойств дополнение к тем [на всех конечных объектов каталога](#catalog-leaf).

`version` Свойство является исходной версии строки из файла пакета nuspec.

`published` Свойство — это время, когда пакет был удален, как правило, как короткое время перед меткой времени фиксации элемента каталога.

#### <a name="sample-request"></a>Пример запроса

ПОЛУЧИТЬ https://api.nuget.org/v3/catalog0/data/2017.11.02.00.40.00/netstandard1.4_lib.1.0.0-test.json

#### <a name="sample-response"></a>Пример ответа

[!code-JSON [catalog-package-delete.json](./_data/catalog-package-delete.json)]

## <a name="cursor"></a>Курсор

### <a name="overview"></a>Обзор

В этом разделе описывается понятием клиента, несмотря на то, что не является обязательной обязательно протоколом, должны быть частью любой реализации практические каталога клиента.

Поскольку каталог является структурой данных только для добавления, индексированные по времени, клиент следует хранить **курсор** локально, представляющий не более чем на момент времени клиент обработал элементы каталога. Обратите внимание на то, что это значение курсор должен никогда не создаются с помощью часов компьютера клиента. Вместо этого значение должны поступать из объекта каталога `commitTimestamp` значение.

Каждый раз, клиент должен обработать новые события в источнике пакета, ему требуется только запрос каталога для всех элементов каталога с меткой времени фиксации больше, чем его хранимых курсора. После того как клиент успешно обработает все новые элементы каталога, он записывает последнюю метку времени фиксации позиций каталога, просто обрабатывается как его новое значение курсора.

При таком подходе, клиент может быть убедитесь, что никогда не пропустите любой пакет событий, произошедших в источнике пакета.
Кроме того клиент никогда не должен повторно обработать старые события до метки времени фиксации записанные курсора.

Такая концепция курсоров используется для многих nuget.org фоновых заданий и используется для обновления самого API V3. 

### <a name="initial-value"></a>Исходное значение

Когда клиент каталога запускается в первый раз (и поэтому не имеет курсора значения), следует использовать значение по умолчанию курсор. NET `System.DateTimeOffset.MinValue` или таких аналогом намек на Минимальная метка времени, которое может быть представлено.

### <a name="iterating-over-catalog-items"></a>Перебор элементов каталога

Чтобы запросить следующий набор элементов каталога для обработки, клиент должен выполнить следующее.

1. Получить значение записанные курсора из локального хранилища.
1. Скачайте и десериализации индекс каталога.
1. Найти все каталога страниц с меткой времени фиксации *больше, чем* курсор.
1. Объявите пустой список элементов каталога для обработки.
1. Для каждой страницы каталога, в шаге 3:
   1. Скачайте и десериализации на странице каталога.
   1. Найти все товары с меткой времени фиксации в каталог *больше, чем* курсор.
   1. Добавьте все подходящие элементы каталога в список, объявленные на шаге 4.
1. Сортировать список элементов каталога по метке времени фиксации.
1. Обработки каждого элемента каталога в последовательности:
   1. Скачайте и десериализации данного элемента каталога.
   1. Реакцию на тип элемента каталога.
   1. Обработать документ элемент каталога образом относящиеся к клиенту.
1. Запишите меткой времени фиксации последнего элемента каталога, как новое значение курсора.

Этот основной алгоритм реализация клиента позволяет создавать копии получить полное представление о всех пакетов, доступных в источнике пакета. Клиент должны выполнять только этот алгоритм периодически, которые всегда следует учитывать изменения источника пакета.

> [!Note]
> Это алгоритм, nuget.org используют, чтобы обеспечить [метаданные пакета](registration-base-url-resource.md), [содержимое пакета](package-base-address-resource.md), [поиска](search-query-service-resource.md) и [автозаполнения](search-autocomplete-service-resource.md) ресурсы в актуальном состоянии.

### <a name="dependent-cursors"></a>Зависимые курсоров

Предположим, что существует два клиента каталога, которые имеют зависимость, присущие, где выходные данные одного клиента зависит от выходных данных другого клиента. 

#### <a name="example"></a>Пример

Например на сайте nuget.org только что опубликованный пакет не должен появляться в поисковый ресурс прежде чем он появится в ресурсе метаданных пакета. Это обусловлено «restore» операция, выполняемая официального клиента NuGet использует ресурс метаданных пакета. Если клиент обнаруживает пакета с помощью службы поиска, они должны быть удалось успешно восстановить этот пакет, используя ресурс метаданных пакета. Другими словами поисковый ресурс зависит от ресурс метаданных пакета. Каждый ресурс имеет обновление ресурса каталога клиента фонового задания. Каждый клиент имеет собственный курсора.

Так как оба ресурса создаются из каталога, курсор клиента каталога, который обновляет ресурс поиска *не должен превышать* курсора клиента каталога метаданных пакета.

#### <a name="algorithm"></a>Алгоритм

Чтобы реализовать это ограничение, просто измените алгоритм выше, чтобы быть:

1. Получить значение записанные курсора из локального хранилища.
1. Скачайте и десериализации индекс каталога.
1. Найти все каталога страниц с меткой времени фиксации *больше, чем* курсор **меньше или равно зависимости курсора.**
1. Объявите пустой список элементов каталога для обработки.
1. Для каждой страницы каталога, в шаге 3:
   1. Скачайте и десериализации на странице каталога.
   1. Найти все товары с меткой времени фиксации в каталог *больше, чем* курсор **меньше или равно зависимости курсора.**
   1. Добавьте все подходящие элементы каталога в список, объявленные на шаге 4.
1. Сортировать список элементов каталога по метке времени фиксации.
1. Обработки каждого элемента каталога в последовательности:
   1. Скачайте и десериализации данного элемента каталога.
   1. Реакцию на тип элемента каталога.
   1. Обработать документ элемент каталога образом относящиеся к клиенту.
1. Запишите меткой времени фиксации последнего элемента каталога, как новое значение курсора.

С помощью этого изменения алгоритма, вы могли бы создать систему каталога зависимых клиентов все создавать свои собственные конкретные индексы, артефакты и т. д.
