---
title: Протоколы nuget.org
description: Развивающиеся протоколы nuget.org для взаимодействия с клиентами NuGet.
author: anangaur
ms.author: anangaur
ms.date: 01/21/2021
ms.topic: conceptual
ms.reviewer: kraigb
ms.openlocfilehash: ea072484c896c4862e47b2c03a1b177f196b0aad
ms.sourcegitcommit: ee6c3f203648a5561c809db54ebeb1d0f0598b68
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/26/2021
ms.locfileid: "98773969"
---
# <a name="nugetorg-protocols"></a>Протоколы nuget.org

Для взаимодействия с nuget.org клиентам необходимо соблюдать определенные протоколы. Так как эти протоколы продолжают развиваться, клиенты должны указать используемую версию протокола при вызове конкретных API-интерфейсов nuget.org. Это позволяет nuget.org внести изменения в некритический способ для старых клиентов.

> [!Note]
> API-интерфейсы, описанные на этой странице, относятся только к nuget.org и не предполагают, что другие реализации сервера NuGet могут ввести эти API. 

Дополнительные сведения об API NuGet, реализованном в экосистеме NuGet, см. в [обзоре API](overview.md).

В этом разделе перечислены различные протоколы как и, когда они бывают.

## <a name="nuget-protocol-version-410"></a>Версия протокола NuGet 4.1.0

Протокол 4.1.0 задает использование ключей проверки области для взаимодействия со службами, отличными от nuget.org, для проверки пакета на соответствие учетной записи nuget.org. Обратите внимание, что `4.1.0` номер версии является непрозрачной строкой, но совпадает с первой версией официального клиента NuGet, который поддерживал этот протокол.

Проверка гарантирует, что создаваемые пользователем ключи API будут использоваться только с nuget.org, а другие проверки или проверки из сторонней службы обрабатываются посредством однократного использования ключей проверки области. Эти ключи проверки можно использовать для проверки принадлежности пакета определенному пользователю (учетной записи) в nuget.org.

### <a name="client-requirement"></a>Требование клиента

Клиентам необходимо передать следующий заголовок, если они выполняют вызовы API для **отправки** пакетов в NuGet.org:

```
X-NuGet-Protocol-Version: 4.1.0
```

Обратите внимание, что `X-NuGet-Client-Version` заголовок имеет подобную семантику, но зарезервировано только официальным клиентом NuGet. Сторонние клиенты должны использовать `X-NuGet-Protocol-Version` заголовок и значение.

Сам протокол **push-уведомлений** описан в документации по [ `PackagePublish` ресурсу](package-publish-resource.md).

Если клиент взаимодействует с внешними службами и должен проверить, принадлежит ли пакет определенному пользователю (учетная запись), он должен использовать следующий протокол и использовать ключи проверки области, а не ключи API из nuget.org.

### <a name="api-to-request-a-verify-scope-key"></a>API для запроса ключа проверки

Этот API используется для получения ключа проверки области действия для автора nuget.org для проверки пакета, принадлежащего ему.

```
POST api/v2/package/create-verification-key/{ID}/{VERSION}
```

#### <a name="request-parameters"></a>Параметры запроса

Имя           | В     | Тип   | Обязательно | Примечания
-------------- | ------ | ------ | -------- | -----
ID             | URL-адрес    | строка | yes      | Пакет идентидиер, для которого запрашивается ключ области проверки
VERSION        | URL-адрес    | строка | нет       | Версия пакета
X-NuGet-ApiKey | Header | строка | yes      | Например: `X-NuGet-ApiKey: {USER_API_KEY}`

#### <a name="response"></a>Ответ

```json
{
    "Key": "{Verify scope key from nuget.org}",
    "Expires": "{Date}"
}
```

### <a name="api-to-verify-the-verify-scope-key"></a>API для проверки ключа области проверки

Этот API используется для проверки ключа проверки области действия для пакета, принадлежащего автору nuget.org.

```
GET api/v2/verifykey/{ID}/{VERSION}
```

#### <a name="request-parameters"></a>Параметры запроса

Имя           | В     | Тип   | Обязательно | Примечания
-------------  | ------ | ------ | -------- | -----
ID             | URL-адрес    | строка | yes      | Идентификатор пакета, для которого запрашивается ключ области проверки
VERSION        | URL-адрес    | строка | нет       | Версия пакета
X-NuGet-ApiKey | Header | строка | yes      | Например: `X-NuGet-ApiKey: {VERIFY_SCOPE_KEY}`

> [!Note]
> Срок действия ключа API области проверки истекает через день или при первом использовании, в зависимости от того, что происходит раньше.

#### <a name="response"></a>Ответ

Код состояния | Значение
----------- | -------
200         | Ключ API является допустимым
403         | Ключ API является недопустимым или не разрешен для отправки в пакет
404         | Пакет, на который ссылается, `ID` и `VERSION` (необязательно) не существует
