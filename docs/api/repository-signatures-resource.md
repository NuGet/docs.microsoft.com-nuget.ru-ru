---
title: Подписи репозитория, API NuGet | Документация Майкрософт
author: joelverhagen
ms.author: jver
ms.date: 3/2/2018
ms.topic: reference
description: Ресурс "подписи репозитория" позволяет источникам пакетов клиентов объявлять свои возможности подписывания репозитория.
ms.reviewer:
- karann
- unniravindranathan
ms.openlocfilehash: bfdbbb3a11de3be3f2258a3a289c0188740cdfce
ms.sourcegitcommit: ee6c3f203648a5561c809db54ebeb1d0f0598b68
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/26/2021
ms.locfileid: "98775330"
---
# <a name="repository-signatures"></a>Подписи репозитория

Если источник пакета поддерживает добавление подписей репозитория в опубликованные пакеты, клиент может определить сертификаты подписи, используемые источником пакета. Этот ресурс позволяет клиентам определить, был ли подписанный в репозиторий пакет изменен или имеет непредвиденный сертификат подписи.

Ресурс, используемый для получения сведений о подписи репозитория, — это `RepositorySignatures` ресурс, найденный в [индексе службы](service-index.md).

## <a name="versioning"></a>Управление версиями

Используется следующее `@type` значение:

Значение @type                | Примечания
-------------------------- | -----
Репоситорисигнатурес/4.7.0 | Первоначальный выпуск
Репоситорисигнатурес/4.9.0 | Поддерживается клиентами NuGet v 4.9 +
Репоситорисигнатурес/5.0.0 | Позволяет включить `allRepositorySigned` . Поддерживается клиентами NuGet версии 5.0 и более поздних версий

## <a name="base-url"></a>Базовый URL-адрес

URL-адрес точки входа для следующих API-интерфейсов — это значение `@id` свойства, связанного с вышеупомянутым `@type` значением ресурса. В этом разделе используется URL-адрес заполнителя `{@id}` .

Обратите внимание, что, в отличие от других ресурсов, `{@id}` URL-адрес должен обрабатываться по протоколу HTTPS.

## <a name="http-methods"></a>Методы HTTP

Все URL-адреса, найденные в ресурсе сигнатур репозитория, поддерживают только методы HTTP `GET` и `HEAD` .

## <a name="repository-signatures-index"></a>Индекс подписей репозитория

Индекс подписей репозитория содержит два фрагмента информации:

1. Являются ли все пакеты, найденные в источнике, подписанными этим источником пакетов.
1. Список сертификатов, используемых источником пакета для подписи пакетов.

В большинстве случаев список сертификатов будет добавляться к. Новые сертификаты добавляются в список, когда истечет срок действия предыдущего сертификата для подписи, и источнику пакета необходимо начать использовать новый сертификат подписи. Если сертификат удален из списка, это означает, что все подписи пакетов, созданные с помощью удаленного сертификата подписи, больше не должны считаться действительными для клиента. В этом случае подпись пакета (но не обязательно пакет) является недопустимой. Политика клиента может разрешить установку пакета без знака.

В случае отзыва сертификата (например, Компрометация ключа) предполагается, что источник пакета повторно подписывает все пакеты, подписанные затронутым сертификатом. Кроме того, источник пакета должен удалить затронутый сертификат из списка сертификатов для подписи.

Следующий запрос извлекает индекс подписей репозитория.

```
GET {@id}
```

Индекс подписи репозитория — это документ JSON, содержащий объект со следующими свойствами:

Имя                | Тип             | Обязательно | Примечания
------------------- | ---------------- | -------- | -----
аллрепоситорисигнед | Логическое          | yes      | Должен быть `false` для ресурсов 4.7.0 и 4.9.0
сигнингцертификатес | массив объектов | yes      | 

`allRepositorySigned`Логическое значение равно false, если источник пакета содержит пакеты, не имеющие подписи репозитория. Если для логического свойства задано значение true, то все пакеты, доступные в источнике, должны иметь подпись репозитория, созданную одним из сертификатов подписи, упомянутых в `signingCertificates` .

> [!Warning]
> `allRepositorySigned`Для ресурсов 4.7.0 и 4.9.0 логическое значение должно быть равно false. Клиенты NuGet v 4.7, v 4.8 и v 4.9 не могут устанавливать пакеты из источников, `allRepositorySigned` для которых задано значение true.

Если логическое значение равно true, в массиве должен быть один или несколько сертификатов для подписи `signingCertificates` `allRepositorySigned` . Если массив пуст и `allRepositorySigned` имеет значение true, все пакеты из источника должны рассматриваться как недопустимые, хотя политика клиента может по-прежнему разрешать использование пакетов. Каждый элемент в этом массиве является объектом JSON со следующими свойствами.

Имя         | Тип   | Обязательно | Примечания
------------ | ------ | -------- | -----
contentUrl   | строка | yes      | Абсолютный URL-адрес общедоступного сертификата в формате DER
отпечатков | object | yes      |
subject      | строка | yes      | Различающееся имя субъекта из сертификата
issuer       | строка | yes      | Различающееся имя издателя сертификата
notBefore    | строка | yes      | Метка времени начала срока действия сертификата
notAfter     | строка | yes      | Конечная метка времени периода действия сертификата

Обратите внимание, что объект должен обрабатываться `contentUrl` по протоколу HTTPS. Этот URL-адрес не имеет конкретного шаблона URL-адреса и должен быть динамически обнаружен с помощью этого документа индекса подписей репозитория. 

Все свойства в этом объекте (помимо `contentUrl` ) должны быть производными от сертификата, найденного в `contentUrl` .
Эти производные свойства предоставляются в качестве удобства для снижения круговых путей.

Объект `fingerprints` имеет следующие свойства.

Имя                   | Тип   | Обязательно | Примечания
---------------------- | ------ | -------- | -----
2.16.840.1.101.3.4.2.1 | строка | yes      | Отпечаток SHA-256

Имя ключа `2.16.840.1.101.3.4.2.1` — OID алгоритма хеширования SHA-256.

Все хэш-значения должны быть строчными и строковыми, закодированными шестнадцатеричным форматом хэш-хэша.

### <a name="sample-request"></a>Пример запроса

```
GET https://api.nuget.org/v3-index/repository-signatures/index.json
```

### <a name="sample-response"></a>Пример ответа

[!code-JSON [repository-signatures-index.json](./_data/repository-signatures-index.json)]
