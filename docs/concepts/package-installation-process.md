---
title: Процесс установки пакета
description: Подробные сведения о процессе установки пакета
author: karann-msft
ms.author: karann
ms.date: 06/20/2019
ms.topic: conceptual
ms.openlocfilehash: 5676239bedb7f8fbe9f74725864afd297405d5c1
ms.sourcegitcommit: 0dea3b153ef823230a9d5f38351b7cef057cb299
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/12/2019
ms.locfileid: "67842336"
---
# <a name="what-happens-when-a-nuget-package-is-installed"></a><span data-ttu-id="43255-103">Процесс установки пакета NuGet</span><span class="sxs-lookup"><span data-stu-id="43255-103">What happens when a NuGet package is installed?</span></span>

<span data-ttu-id="43255-104">Попросту говоря, различные средства NuGet обычно создают ссылку на пакет в файле проекта или файле `packages.config`, а затем восстанавливают пакет, фактически устанавливая его.</span><span class="sxs-lookup"><span data-stu-id="43255-104">Simply said, the different NuGet tools typically create a reference to a package in the project file or `packages.config`, then perform a package restore, which effectively installs the package.</span></span> <span data-ttu-id="43255-105">Исключение составляет команда `nuget install`, которая только добавляет пакет в папку `packages` и не меняет какие-либо другие файлы.</span><span class="sxs-lookup"><span data-stu-id="43255-105">The exception is `nuget install`, which only expands the package into a `packages` folder and does not modify any other files.</span></span>

<span data-ttu-id="43255-106">Общий процесс выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="43255-106">The general process is as follows:</span></span>

1. <span data-ttu-id="43255-107">(Все средства, кроме `nuget.exe`.) Записывает идентификатор и версию пакета в файл проекта или файл `packages.config`.</span><span class="sxs-lookup"><span data-stu-id="43255-107">(All tools except `nuget.exe`) Record the package identifier and version into the project file or `packages.config`.</span></span>

   <span data-ttu-id="43255-108">Если для установки используется Visual Studio или интерфейс командной строки dotnet, в первую очередь предпринимается попытка установить пакет.</span><span class="sxs-lookup"><span data-stu-id="43255-108">If the installation tool is Visual Studio or the dotnet CLI, the tool first attempts to install the package.</span></span> <span data-ttu-id="43255-109">Если пакет не является совместимым, он не добавляется в файл проекта или в файл `packages.config`.</span><span class="sxs-lookup"><span data-stu-id="43255-109">If it's incompatible, the package is not added to the project file or `packages.config`.</span></span>

2. <span data-ttu-id="43255-110">Получает сам пакет:</span><span class="sxs-lookup"><span data-stu-id="43255-110">Acquire the package:</span></span>
   - <span data-ttu-id="43255-111">Проверяет, установлен ли пакет (по точному идентификатору и номеру версии) в папке *global-packages*, как описано в статье [Управление папкой установки глобальных пакетов, кэшем и временными папками](../consume-packages/managing-the-global-packages-and-cache-folders.md).</span><span class="sxs-lookup"><span data-stu-id="43255-111">Check if the package (by exact identifer and version number) is already installed in the *global-packages* folder as described on [Managing the global packages and cache folders](../consume-packages/managing-the-global-packages-and-cache-folders.md).</span></span>

   - <span data-ttu-id="43255-112">Если пакета нет в папке *global-packages*, выполняется попытка извлечь пакет из источников, перечисленных в [файлах конфигурации](../consume-packages/Configuring-NuGet-Behavior.md).</span><span class="sxs-lookup"><span data-stu-id="43255-112">If the package is not in the *global-packages* folder, attempt to retrieve it from the sources listed listed in the [configuration files](../consume-packages/Configuring-NuGet-Behavior.md).</span></span> <span data-ttu-id="43255-113">Если источники сетевые, выполняется попытка извлечь пакет из кэша HTTP, когда не указан параметр `-NoCache` с помощью команды `nuget.exe` или параметр `--no-cache` с помощью команды `dotnet restore`.</span><span class="sxs-lookup"><span data-stu-id="43255-113">For online sources, attempt first to retrieve the package from the HTTP cache unless `-NoCache` is specified with `nuget.exe` commands or `--no-cache` is specified with `dotnet restore`.</span></span> <span data-ttu-id="43255-114">(Visual Studio и `dotnet add package` всегда используют кэш.) При использовании пакета из кэша в выходных данных отображается параметр CACHE.</span><span class="sxs-lookup"><span data-stu-id="43255-114">(Visual Studio and `dotnet add package` always use the cache.) If a package is used from the cache, "CACHE" appears in the output.</span></span> <span data-ttu-id="43255-115">Срок действия кэша составляет 30 минут.</span><span class="sxs-lookup"><span data-stu-id="43255-115">The cache has an expiration time of 30 minutes.</span></span>

   - <span data-ttu-id="43255-116">Если пакета нет в кэше HTTP, выполняется попытка скачать его из источников, перечисленных в файлах конфигурации.</span><span class="sxs-lookup"><span data-stu-id="43255-116">If the package is not in the HTTP cache, attempt to download it from the sources listed in the configuration.</span></span> <span data-ttu-id="43255-117">После скачивания пакета в выходных данных отображается параметр GET и ОК.</span><span class="sxs-lookup"><span data-stu-id="43255-117">If a package is downloaded, "GET" and "OK" appear in the output.</span></span> <span data-ttu-id="43255-118">NuGet ведет журнал трафика HTTP с обычным уровнем детализации.</span><span class="sxs-lookup"><span data-stu-id="43255-118">NuGet logs http traffic on normal verbosity.</span></span>

   - <span data-ttu-id="43255-119">Если пакет не удается извлечь из любых источников, на этом этапе установка завершится ошибкой, например [NU1103](../reference/errors-and-warnings/NU1103.md).</span><span class="sxs-lookup"><span data-stu-id="43255-119">If the package cannot be successfully acquired from any sources, installation fails at this point with an error such as [NU1103](../reference/errors-and-warnings/NU1103.md).</span></span> <span data-ttu-id="43255-120">Обратите внимание, что в выходных данных ошибок выполнения команд `nuget.exe` отображается только последний проверенный источник, но подразумевается, что пакет отсутствует во всех.</span><span class="sxs-lookup"><span data-stu-id="43255-120">Note that errors from `nuget.exe` commands show only the last source checked, but implies that the package wasn't available from any source.</span></span>

   <span data-ttu-id="43255-121">При извлечении пакета с помощью NuGet источники проверяются в таком порядке:</span><span class="sxs-lookup"><span data-stu-id="43255-121">When acquiring the package, the order of sources in the NuGet configuration may apply:</span></span>

   - <span data-ttu-id="43255-122">NuGet проверяет папку локальных источников и сетевые папки, а затем источники HTTP.</span><span class="sxs-lookup"><span data-stu-id="43255-122">NuGet checks sources local folder and network shares before checking HTTP sources.</span></span>

3. <span data-ttu-id="43255-123">Сохраняет копию пакета и другие сведения в папке *http-cache*, как описано в статье [Управление глобальными пакетами и папками кэша](../consume-packages/managing-the-global-packages-and-cache-folders.md).</span><span class="sxs-lookup"><span data-stu-id="43255-123">Save a copy of the package and other information in the *http-cache* folder as described on [Managing the global packages and cache folders](../consume-packages/managing-the-global-packages-and-cache-folders.md).</span></span>

4. <span data-ttu-id="43255-124">После загрузки устанавливает в папке *global-packages* пользователя.</span><span class="sxs-lookup"><span data-stu-id="43255-124">If downloaded, install the package into the per-user *global-packages* folder.</span></span> <span data-ttu-id="43255-125">NuGet создает вложенную папку для каждого идентификатора пакета, а затем создает вложенные папки для каждой установленной версии пакета.</span><span class="sxs-lookup"><span data-stu-id="43255-125">NuGet creates a subfolder for each package identifier, then creates subfolders for each installed version of the package.</span></span>

5. <span data-ttu-id="43255-126">При необходимости NuGet устанавливает зависимые компоненты пакета.</span><span class="sxs-lookup"><span data-stu-id="43255-126">NuGet installs package dependencies as required.</span></span> <span data-ttu-id="43255-127">Этот процесс может обновить версии пакетов, как описано в статье [Принципы разрешения зависимостей пакетов в NuGet](../consume-packages/dependency-resolution.md).</span><span class="sxs-lookup"><span data-stu-id="43255-127">This process might update package versions in the process, as described in [Dependency Resolution](../consume-packages/dependency-resolution.md).</span></span>

6. <span data-ttu-id="43255-128">Обновление других файлов и папок проекта:</span><span class="sxs-lookup"><span data-stu-id="43255-128">Update other project files and folders:</span></span>

    - <span data-ttu-id="43255-129">В проектах, использующих PackageReference, обновляет схему зависимостей пакетов, хранящихся в файле `obj/project.assets.json`.</span><span class="sxs-lookup"><span data-stu-id="43255-129">For projects using PackageReference, update the package dependency graph stored in `obj/project.assets.json`.</span></span> <span data-ttu-id="43255-130">Само содержимое пакета не копируется в какую-либо папку проекта.</span><span class="sxs-lookup"><span data-stu-id="43255-130">Package contents themselves are not copied into any project folder.</span></span>
    - <span data-ttu-id="43255-131">Обновляет `app.config` и (или) `web.config`, если пакет использует [преобразования источника и файла конфигурации](../create-packages/source-and-config-file-transformations.md).</span><span class="sxs-lookup"><span data-stu-id="43255-131">Update `app.config` and/or `web.config` if the package uses [source and config file transformations](../create-packages/source-and-config-file-transformations.md).</span></span>

7. <span data-ttu-id="43255-132">(Только Visual Studio.) Отображает файл сведений пакета (если он доступен) в окне Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="43255-132">(Visual Studio only) Display the package's readme file, if available, in a Visual Studio window.</span></span>

<span data-ttu-id="43255-133">Оцените преимущества в эффективности написания кода с использованием пакетов NuGet!</span><span class="sxs-lookup"><span data-stu-id="43255-133">Enjoy your productive coding with NuGet packages!</span></span>
