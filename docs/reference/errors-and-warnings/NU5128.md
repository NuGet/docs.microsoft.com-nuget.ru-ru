---
title: NU5125 предупреждения NuGet
description: Код предупреждения NU5125
author: zivkan
ms.date: 09/06/2019
ms.topic: reference
ms.reviewer: karann
f1_keywords:
- NU5128
ms.openlocfilehash: 58550b2064689ebf6180b1211e1910a71debf341
ms.sourcegitcommit: 1eda83ab537c86cc27316e7bc67f95a358766e63
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/18/2019
ms.locfileid: "71099075"
---
# <a name="nuget-warning-nu5128"></a><span data-ttu-id="d0af6-103">NU5128 предупреждения NuGet</span><span class="sxs-lookup"><span data-stu-id="d0af6-103">NuGet Warning NU5128</span></span>

## <a name="scenario-1"></a><span data-ttu-id="d0af6-104">Сценарий 1.</span><span class="sxs-lookup"><span data-stu-id="d0af6-104">Scenario 1</span></span>

<pre>Some target frameworks declared in the dependencies group of the nuspec and the lib/ref folder do not have exact matches in the other location. Consult the list of actions below:
- Add a dependency group for .NETStandard2.0 to the nuspec</pre>

### <a name="issue"></a><span data-ttu-id="d0af6-105">Проблемы</span><span class="sxs-lookup"><span data-stu-id="d0af6-105">Issue</span></span>

<span data-ttu-id="d0af6-106">Каталог `lib/<tfm>/` или`ref/<tfm>/` в пакете содержит по крайней мере один файл для [моникера целевой платформы (TFM)](../target-frameworks.md) , указанного в сообщении с предупреждением.</span><span class="sxs-lookup"><span data-stu-id="d0af6-106">The `lib/<tfm>/` or `ref/<tfm>/` directory in the package contains at least one file for the [Target Framework Moniker (TFM)](../target-frameworks.md) specified in the warning message.</span></span> <span data-ttu-id="d0af6-107">Однако для этого TFM в `nuspec` файле не существует группы зависимостей.</span><span class="sxs-lookup"><span data-stu-id="d0af6-107">However, no dependency group exists for this TFM in the `nuspec` file.</span></span> <span data-ttu-id="d0af6-108">Это может привести к тому, что потребители пакета будут предполагать, что пакет несовместим с TFM.</span><span class="sxs-lookup"><span data-stu-id="d0af6-108">This may cause package consumers to believe the package is not compatible with the TFM.</span></span>

### <a name="solution"></a><span data-ttu-id="d0af6-109">Решение</span><span class="sxs-lookup"><span data-stu-id="d0af6-109">Solution</span></span>

* <span data-ttu-id="d0af6-110">Запустить пакет для проекта</span><span class="sxs-lookup"><span data-stu-id="d0af6-110">Run pack on the project</span></span>

<span data-ttu-id="d0af6-111">По возможности используйте [задачу "пакет MSBuild](../msbuild-targets.md)" для NuGet, так как она автоматически сопоставляет сборку TFM с группами зависимостей из целевых платформ проекта.</span><span class="sxs-lookup"><span data-stu-id="d0af6-111">If possible, use [NuGet's MSBuild pack task](../msbuild-targets.md), as it automatically matches assembly TFMs with dependency groups from the project's target frameworks.</span></span> <span data-ttu-id="d0af6-112">Обратите внимание, что проект `PackageReference` должен использоваться для собственных зависимостей NuGet.</span><span class="sxs-lookup"><span data-stu-id="d0af6-112">Note that your project must use `PackageReference` for its own NuGet dependencies.</span></span> <span data-ttu-id="d0af6-113">Если в проекте используется Packages. config, необходимо использовать `nuget.exe pack` `nuspec` и файл.</span><span class="sxs-lookup"><span data-stu-id="d0af6-113">If your project uses packages.config, you need to use `nuget.exe pack` and a `nuspec` file.</span></span>

* <span data-ttu-id="d0af6-114">Измененный `nuspec` вручную файл</span><span class="sxs-lookup"><span data-stu-id="d0af6-114">Manually edited `nuspec` file</span></span>

<span data-ttu-id="d0af6-115">При использовании пользовательского `nuspec` файла рекомендуется, чтобы каждый TFM, для `ref/` которого `lib/` существуют сборки, соответствовал соответствующей группе зависимостей, даже если зависимости совпадают со следующими совместимыми TFM.</span><span class="sxs-lookup"><span data-stu-id="d0af6-115">If you are using a custom `nuspec` file, we recommend each TFM for which `lib/` or `ref/` assemblies exist should have a matching dependency group, even if the dependencies are the same as the next compatible TFM.</span></span> <span data-ttu-id="d0af6-116">Например, если пакет содержит `netstandard1.0` сборки и `netstandard2.0` , а зависимости одинаковы для обоих типов, мы рекомендуем использовать оба TFM в качестве групп зависимостей с повторяющимися элементами зависимостей.</span><span class="sxs-lookup"><span data-stu-id="d0af6-116">For example, if a package contains `netstandard1.0` and `netstandard2.0` assemblies, and the dependencies are the same for both, we recommend both TFMs be listed as dependency groups with duplicate dependency items.</span></span>

<span data-ttu-id="d0af6-117">Обратите внимание, что идентификатор TFM, используемый в путях сборок, использует другой формат идентификатора TFM, используемого в группах зависимостей.</span><span class="sxs-lookup"><span data-stu-id="d0af6-117">Note that the TFM identifier used in the assembly paths use a different format to the TFM identifier used in dependency groups.</span></span> <span data-ttu-id="d0af6-118">Предупреждающее сообщение указывает правильное имя для использования в группе зависимостей.</span><span class="sxs-lookup"><span data-stu-id="d0af6-118">The warning message specifies the correct name to use in the dependency group.</span></span> <span data-ttu-id="d0af6-119">Если у пакета нет зависимостей для этой целевой платформы, используйте пустую группу.</span><span class="sxs-lookup"><span data-stu-id="d0af6-119">If your package does not have any dependencies for that target framework, use an empty group.</span></span> <span data-ttu-id="d0af6-120">Например:</span><span class="sxs-lookup"><span data-stu-id="d0af6-120">For example:</span></span>

```xml
<package>
  <metadata>
    ...
    <dependencies>
      <group targetFramework=".NETFramework4.7.2" />
    </dependencies>
  </metadata>
  ...
<package>
```

* <span data-ttu-id="d0af6-121">`ref/` Удаление файлов `lib/` или</span><span class="sxs-lookup"><span data-stu-id="d0af6-121">Remove the `lib/` or `ref/` files</span></span>

<span data-ttu-id="d0af6-122">Если вы не хотите, чтобы пакет был совместим с сообщаемым TFM, измените проект таким способом, чтобы в `lib/<tfm>/` пакете `ref/<tfm>/` для этого TFM не было файлов или.</span><span class="sxs-lookup"><span data-stu-id="d0af6-122">If you do not wish your package to be compatible with the reported TFM, modify your project such that no `lib/<tfm>/` or `ref/<tfm>/` files are in the package for that TFM.</span></span> <span data-ttu-id="d0af6-123">Например, если предупреждение говорит о `.NETFramework4.7.2` добавлении группы зависимостей для `nuspec`в, удалите все `lib/net472/*` файлы и `ref/net472/*` из пакета.</span><span class="sxs-lookup"><span data-stu-id="d0af6-123">For example, if the warning says to add a dependency group for `.NETFramework4.7.2` to the `nuspec`, then remove any `lib/net472/*` and `ref/net472/*` files from your package.</span></span>

## <a name="scenario-2"></a><span data-ttu-id="d0af6-124">Сценарий 2.</span><span class="sxs-lookup"><span data-stu-id="d0af6-124">Scenario 2</span></span>

<pre>Some target frameworks declared in the dependencies group of the nuspec and the lib/ref folder do not have exact matches in the other location. Consult the list of actions below:
- Add lib or ref assemblies for the netstandard2.0 target framework</pre>

### <a name="issue"></a><span data-ttu-id="d0af6-125">Проблемы</span><span class="sxs-lookup"><span data-stu-id="d0af6-125">Issue</span></span>

<span data-ttu-id="d0af6-126">Файл имеет группу зависимостей для сообщаемого моникера целевой платформы (TFM), но для этого TFM не существует сборок `lib/` в или `ref/`. `nuspec`</span><span class="sxs-lookup"><span data-stu-id="d0af6-126">The `nuspec` file has a dependency group for the reported Target Framework Moniker (TFM), but no assemblies exist for this TFM in either `lib/` or `ref/`.</span></span> <span data-ttu-id="d0af6-127">Если имеются сборки для совместимого TFM, пакет по-прежнему будет устанавливаться, но зависимости могут быть неправильными для сборок, используемых во время компиляции, и могут привести к сбою проекта в среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="d0af6-127">If there are assemblies for a compatible TFM, the package will still install, but the dependencies might be incorrect for a assemblies used at compile time and could cause the project to fail at runtime.</span></span>

### <a name="solution"></a><span data-ttu-id="d0af6-128">Решение</span><span class="sxs-lookup"><span data-stu-id="d0af6-128">Solution</span></span>

* <span data-ttu-id="d0af6-129">Запустить пакет для проекта</span><span class="sxs-lookup"><span data-stu-id="d0af6-129">Run pack on the project</span></span>

<span data-ttu-id="d0af6-130">По возможности используйте [задачу "пакет MSBuild](../msbuild-targets.md)" для NuGet, так как она автоматически сопоставляет сборку TFM с группами зависимостей из целевых платформ проекта.</span><span class="sxs-lookup"><span data-stu-id="d0af6-130">If possible, use [NuGet's MSBuild pack task](../msbuild-targets.md), as it automatically matches assembly TFMs with dependency groups from the project's target frameworks.</span></span> <span data-ttu-id="d0af6-131">Обратите внимание, что проект `PackageReference` должен использоваться для собственных зависимостей NuGet.</span><span class="sxs-lookup"><span data-stu-id="d0af6-131">Note that your project must use `PackageReference` for its own NuGet dependencies.</span></span> <span data-ttu-id="d0af6-132">Если в проекте используется Packages. config, необходимо использовать `nuget.exe pack` `nuspec` и файл.</span><span class="sxs-lookup"><span data-stu-id="d0af6-132">If your project uses packages.config, you need to use `nuget.exe pack` and a `nuspec` file.</span></span>

* <span data-ttu-id="d0af6-133">Измененный `nuspec` вручную файл</span><span class="sxs-lookup"><span data-stu-id="d0af6-133">Manually edited `nuspec` file</span></span>

<span data-ttu-id="d0af6-134">Добавьте сообщаемый TFM в качестве дополнительной целевой платформы, для которой компилируется проект, и добавьте сборки в пакет.</span><span class="sxs-lookup"><span data-stu-id="d0af6-134">Add the reported TFM as an additional Target Framework for which your project compiles for, and add the assemblies to the package.</span></span> <span data-ttu-id="d0af6-135">Если вы используете проект стиля пакета SDK для нескольких целевых TFM, цели пакета MSBuild в NuGet могут автоматически добавлять сборки в соответствующую `lib/<tfm>/` папку и создавать группы зависимостей с правильными TFM и зависимостями.</span><span class="sxs-lookup"><span data-stu-id="d0af6-135">If you are using an SDK style project to multi-target multiple TFMs, NuGet's MSBuild pack targets can automatically add assemblies in the correct `lib/<tfm>/` folder and create dependency groups with the correct TFMs and dependencies.</span></span> <span data-ttu-id="d0af6-136">При использовании проекта, не являющегося стилем SDK, вам, скорее всего, потребуется создать дополнительный файл проекта для дополнительного TFM и изменить `nuspec` файл, чтобы скопировать выходные сборки в нужное расположение в пакете.</span><span class="sxs-lookup"><span data-stu-id="d0af6-136">If you are using a non-SDK style project, you will likely need to create an additional project file for the additional TFM, and modify your `nuspec` file to copy the output assemblies in the correct location in the package.</span></span>

* <span data-ttu-id="d0af6-137">Добавить пустой `_._` файл</span><span class="sxs-lookup"><span data-stu-id="d0af6-137">Add an empty `_._` file</span></span>

<span data-ttu-id="d0af6-138">Если пакет не содержит сборок, таких как meta-пакет, рассмотрите возможность добавления пустого `_._` файла `lib/<tfm>/` в каталоги для TFM, указанного в предупреждении.</span><span class="sxs-lookup"><span data-stu-id="d0af6-138">If your package does not contain any assemblies, such as a meta-package, consider adding an empty `_._` file to the `lib/<tfm>/` directories for the TFMs listed in the warning message.</span></span> <span data-ttu-id="d0af6-139">Например, если предупреждение говорит о добавлении сборок для `netstandard2.0` целевой платформы, создайте пустой `lib/netstandard2.0/_._` файл в пакете.</span><span class="sxs-lookup"><span data-stu-id="d0af6-139">For example, if the warning says to add assemblies for the `netstandard2.0` target framework, create an empty `lib/netstandard2.0/_._` file in your package.</span></span>

* <span data-ttu-id="d0af6-140">Удаление группы зависимостей</span><span class="sxs-lookup"><span data-stu-id="d0af6-140">Remove the dependency group</span></span>

<span data-ttu-id="d0af6-141">Если используется пользовательский `nuspec` файл, удалите группу зависимостей для сообщаемого TFM, в результате чего будут удалены только группы зависимостей для TFM, `lib/<tfm>/` для `ref/<tfm>/` которых существуют файлы.</span><span class="sxs-lookup"><span data-stu-id="d0af6-141">If you use a custom `nuspec` file, remove the dependency group for the reported TFM, leaving only dependency groups for TFMs for which `lib/<tfm>/` or `ref/<tfm>/` files exist.</span></span>

* <span data-ttu-id="d0af6-142">Удалить все зависимости для пакетов, не связанных с сборками</span><span class="sxs-lookup"><span data-stu-id="d0af6-142">Remove all dependencies for packages that are not related to assemblies</span></span>

<span data-ttu-id="d0af6-143">Если пакет не содержит `lib/` файлов или `ref/` и не является мета-пакетом, скорее всего, у него нет зависимостей, необходимых потребителю пакета.</span><span class="sxs-lookup"><span data-stu-id="d0af6-143">If your package does not contain any `lib/` or `ref/` files and is not a meta-package, it likely does not have any dependencies that the package consumer needs.</span></span> <span data-ttu-id="d0af6-144">При упаковке с целевым объектом пакета MSBuild `<SuppressDependenciesWhenPacking>true</SuppressDependenciesWhenPacking>` `PropertyGroup` в NuGet можно задать в файле проекта.</span><span class="sxs-lookup"><span data-stu-id="d0af6-144">If you are packing with NuGet's MSBuild Pack target, you can set `<SuppressDependenciesWhenPacking>true</SuppressDependenciesWhenPacking>` in any `PropertyGroup` in your project file.</span></span> <span data-ttu-id="d0af6-145">Если вы используете пользовательский `nuspec` файл, `<dependencies>` удалите элемент.</span><span class="sxs-lookup"><span data-stu-id="d0af6-145">If you are using a custom `nuspec` file, remove the `<dependencies>` element.</span></span>

* <span data-ttu-id="d0af6-146">Другие сценарии</span><span class="sxs-lookup"><span data-stu-id="d0af6-146">Other scenarios</span></span>

<span data-ttu-id="d0af6-147">Это предупреждение было добавлено во время разработки NuGet 5.3, а первое было доступно в пакет SDK для .NET Core 3,0 Preview 9.</span><span class="sxs-lookup"><span data-stu-id="d0af6-147">This warning was added during NuGet 5.3's development, and first was available in .NET Core SDK 3.0 Preview 9.</span></span> <span data-ttu-id="d0af6-148">[NuGet/Home # 8583](https://github.com/nuget/home/issues/8583) отслеживает проблемы, при которых предупреждение было вызвано слишком большим количеством сценариев.</span><span class="sxs-lookup"><span data-stu-id="d0af6-148">[NuGet/Home#8583](https://github.com/nuget/home/issues/8583) tracks an issue where the warning was being raised in too many scenarios.</span></span> <span data-ttu-id="d0af6-149">Можно использовать `NoWarn` свойство MSBuild (добавить `<NoWarn>$(NoWarn);NU5128</NoWarn>` к любому `PropertyGroup` в файле проекта).</span><span class="sxs-lookup"><span data-stu-id="d0af6-149">You can use the `NoWarn` MSBuild property (add `<NoWarn>$(NoWarn);NU5128</NoWarn>` to any `PropertyGroup` in your project file).</span></span> <span data-ttu-id="d0af6-150">При наличии нескольких затронутых проектов можно использовать [`Directory.Build.targets`](/visualstudio/msbuild/customize-your-build) для автоматического добавления `NoWarn` во все проекты.</span><span class="sxs-lookup"><span data-stu-id="d0af6-150">If you have multiple projects affected, you can use [`Directory.Build.targets`](/visualstudio/msbuild/customize-your-build) to automatically add `NoWarn` to all projects.</span></span>
