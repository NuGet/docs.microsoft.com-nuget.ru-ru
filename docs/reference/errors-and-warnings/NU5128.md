---
title: NU5125 предупреждения NuGet
description: Код предупреждения NU5125
author: zivkan
ms.date: 09/06/2019
ms.topic: reference
ms.reviewer: karann
f1_keywords:
- NU5128
ms.openlocfilehash: 58550b2064689ebf6180b1211e1910a71debf341
ms.sourcegitcommit: 1eda83ab537c86cc27316e7bc67f95a358766e63
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/18/2019
ms.locfileid: "71099075"
---
# <a name="nuget-warning-nu5128"></a>NU5128 предупреждения NuGet

## <a name="scenario-1"></a>Сценарий 1.

<pre>Some target frameworks declared in the dependencies group of the nuspec and the lib/ref folder do not have exact matches in the other location. Consult the list of actions below:
- Add a dependency group for .NETStandard2.0 to the nuspec</pre>

### <a name="issue"></a>Проблемы

Каталог `lib/<tfm>/` или`ref/<tfm>/` в пакете содержит по крайней мере один файл для [моникера целевой платформы (TFM)](../target-frameworks.md) , указанного в сообщении с предупреждением. Однако для этого TFM в `nuspec` файле не существует группы зависимостей. Это может привести к тому, что потребители пакета будут предполагать, что пакет несовместим с TFM.

### <a name="solution"></a>Решение

* Запустить пакет для проекта

По возможности используйте [задачу "пакет MSBuild](../msbuild-targets.md)" для NuGet, так как она автоматически сопоставляет сборку TFM с группами зависимостей из целевых платформ проекта. Обратите внимание, что проект `PackageReference` должен использоваться для собственных зависимостей NuGet. Если в проекте используется Packages. config, необходимо использовать `nuget.exe pack` `nuspec` и файл.

* Измененный `nuspec` вручную файл

При использовании пользовательского `nuspec` файла рекомендуется, чтобы каждый TFM, для `ref/` которого `lib/` существуют сборки, соответствовал соответствующей группе зависимостей, даже если зависимости совпадают со следующими совместимыми TFM. Например, если пакет содержит `netstandard1.0` сборки и `netstandard2.0` , а зависимости одинаковы для обоих типов, мы рекомендуем использовать оба TFM в качестве групп зависимостей с повторяющимися элементами зависимостей.

Обратите внимание, что идентификатор TFM, используемый в путях сборок, использует другой формат идентификатора TFM, используемого в группах зависимостей. Предупреждающее сообщение указывает правильное имя для использования в группе зависимостей. Если у пакета нет зависимостей для этой целевой платформы, используйте пустую группу. Например:

```xml
<package>
  <metadata>
    ...
    <dependencies>
      <group targetFramework=".NETFramework4.7.2" />
    </dependencies>
  </metadata>
  ...
<package>
```

* `ref/` Удаление файлов `lib/` или

Если вы не хотите, чтобы пакет был совместим с сообщаемым TFM, измените проект таким способом, чтобы в `lib/<tfm>/` пакете `ref/<tfm>/` для этого TFM не было файлов или. Например, если предупреждение говорит о `.NETFramework4.7.2` добавлении группы зависимостей для `nuspec`в, удалите все `lib/net472/*` файлы и `ref/net472/*` из пакета.

## <a name="scenario-2"></a>Сценарий 2.

<pre>Some target frameworks declared in the dependencies group of the nuspec and the lib/ref folder do not have exact matches in the other location. Consult the list of actions below:
- Add lib or ref assemblies for the netstandard2.0 target framework</pre>

### <a name="issue"></a>Проблемы

Файл имеет группу зависимостей для сообщаемого моникера целевой платформы (TFM), но для этого TFM не существует сборок `lib/` в или `ref/`. `nuspec` Если имеются сборки для совместимого TFM, пакет по-прежнему будет устанавливаться, но зависимости могут быть неправильными для сборок, используемых во время компиляции, и могут привести к сбою проекта в среде выполнения.

### <a name="solution"></a>Решение

* Запустить пакет для проекта

По возможности используйте [задачу "пакет MSBuild](../msbuild-targets.md)" для NuGet, так как она автоматически сопоставляет сборку TFM с группами зависимостей из целевых платформ проекта. Обратите внимание, что проект `PackageReference` должен использоваться для собственных зависимостей NuGet. Если в проекте используется Packages. config, необходимо использовать `nuget.exe pack` `nuspec` и файл.

* Измененный `nuspec` вручную файл

Добавьте сообщаемый TFM в качестве дополнительной целевой платформы, для которой компилируется проект, и добавьте сборки в пакет. Если вы используете проект стиля пакета SDK для нескольких целевых TFM, цели пакета MSBuild в NuGet могут автоматически добавлять сборки в соответствующую `lib/<tfm>/` папку и создавать группы зависимостей с правильными TFM и зависимостями. При использовании проекта, не являющегося стилем SDK, вам, скорее всего, потребуется создать дополнительный файл проекта для дополнительного TFM и изменить `nuspec` файл, чтобы скопировать выходные сборки в нужное расположение в пакете.

* Добавить пустой `_._` файл

Если пакет не содержит сборок, таких как meta-пакет, рассмотрите возможность добавления пустого `_._` файла `lib/<tfm>/` в каталоги для TFM, указанного в предупреждении. Например, если предупреждение говорит о добавлении сборок для `netstandard2.0` целевой платформы, создайте пустой `lib/netstandard2.0/_._` файл в пакете.

* Удаление группы зависимостей

Если используется пользовательский `nuspec` файл, удалите группу зависимостей для сообщаемого TFM, в результате чего будут удалены только группы зависимостей для TFM, `lib/<tfm>/` для `ref/<tfm>/` которых существуют файлы.

* Удалить все зависимости для пакетов, не связанных с сборками

Если пакет не содержит `lib/` файлов или `ref/` и не является мета-пакетом, скорее всего, у него нет зависимостей, необходимых потребителю пакета. При упаковке с целевым объектом пакета MSBuild `<SuppressDependenciesWhenPacking>true</SuppressDependenciesWhenPacking>` `PropertyGroup` в NuGet можно задать в файле проекта. Если вы используете пользовательский `nuspec` файл, `<dependencies>` удалите элемент.

* Другие сценарии

Это предупреждение было добавлено во время разработки NuGet 5.3, а первое было доступно в пакет SDK для .NET Core 3,0 Preview 9. [NuGet/Home # 8583](https://github.com/nuget/home/issues/8583) отслеживает проблемы, при которых предупреждение было вызвано слишком большим количеством сценариев. Можно использовать `NoWarn` свойство MSBuild (добавить `<NoWarn>$(NoWarn);NU5128</NoWarn>` к любому `PropertyGroup` в файле проекта). При наличии нескольких затронутых проектов можно использовать [`Directory.Build.targets`](/visualstudio/msbuild/customize-your-build) для автоматического добавления `NoWarn` во все проекты.
