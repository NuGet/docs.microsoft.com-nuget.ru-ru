---
title: Поставщики учетных данных NuGet для Visual Studio
description: Поставщики учетных данных NuGet проходят проверку подлинности с помощью веб-каналов, реализовав интерфейс Ивскредентиалпровидер в расширении Visual Studio.
author: JonDouglas
ms.author: jodou
ms.date: 01/09/2017
ms.topic: conceptual
ms.openlocfilehash: f324f1e27e0d718571525152fcf16b55b900dbaa
ms.sourcegitcommit: ee6c3f203648a5561c809db54ebeb1d0f0598b68
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/26/2021
ms.locfileid: "98777756"
---
# <a name="authenticating-feeds-in-visual-studio-with-nuget-credential-providers"></a>Проверка подлинности веб-каналов в Visual Studio с помощью поставщиков учетных данных NuGet

Расширение NuGet Visual Studio 3.6 + поддерживает поставщиков учетных данных, которые позволяют NuGet работать с веб-каналами с проверкой подлинности.
После установки поставщика учетных данных NuGet для Visual Studio расширение NuGet для Visual Studio будет автоматически получать и обновлять учетные данные для веб-каналов, прошедших проверку подлинности, по мере необходимости.

Пример реализации можно найти в [примере вскредентиалпровидер](https://github.com/NuGet/Samples/tree/master/VsCredentialProvider).

В среде Visual Studio NuGet использует внутренний объект, `VsCredentialProviderImporter` который также сканирует поставщики учетных данных подключаемых модулей. Эти поставщики учетных данных подключаемых модулей должны быть обнаруживаемыми в качестве экспорта MEF типа `IVsCredentialProvider` .

Начиная с 4.8 + NuGet в Visual Studio, поддерживаются также новые подключаемые модули многоплатформенной проверки подлинности, но они не являются рекомендуемым подходом для повышения производительности.

> [!Note]
> Поставщики учетных данных NuGet для Visual Studio должны быть установлены как обычные расширения Visual Studio, и для них потребуется [Visual studio 2017](https://aka.ms/vs/15/release/vs_enterprise.exe) или более поздней версии.
>
> Поставщики учетных данных NuGet для Visual Studio работают только в Visual Studio (не в dotnet restore или nuget.exe). Сведения о поставщиках учетных данных с nuget.exe см. в разделе [nuget.exe поставщиков учетных данных](nuget-exe-Credential-providers.md).
> Для поставщиков учетных данных в DotNet и MSBuild см. Дополнительные сведения о [подключаемых](nuget-cross-platform-authentication-plugin.md) модулях NuGet.

## <a name="creating-a-nuget-credential-provider-for-visual-studio"></a>Создание поставщика учетных данных NuGet для Visual Studio

Расширение NuGet Visual Studio 3.6 и реализует внутренний Кредентиалсервице, используемый для получения учетных данных. Кредентиалсервице имеет список встроенных поставщиков учетных данных и подключаемых модулей. Каждый поставщик попытается последовательно, пока не будут получены учетные данные.

При получении учетных данных служба учетных данных попытается использовать поставщики учетных данных в следующем порядке, останавливаясь, как только будут получены учетные данные:

1. Учетные данные будут получены из файлов конфигурации NuGet (с помощью встроенной функции `SettingsCredentialProvider` ).
1. Если источник пакета находится в Visual Studio Team Services, `VisualStudioAccountProvider` будет использоваться.
1. Все другие поставщики учетных данных подключаемых модулей Visual Studio будут последовательной попытки.
1. Постарайтесь использовать все межплатформенные поставщики учетных данных NuGet последовательно.
1. Если учетные данные еще не получены, пользователь получит запрос на ввод учетных данных, используя стандартное диалоговое окно обычной проверки подлинности.

### <a name="implementing-ivscredentialprovidergetcredentialsasync"></a>Реализация Ивскредентиалпровидер. Жеткредентиалсасинк

Чтобы создать поставщик учетных данных NuGet для Visual Studio, создайте расширение Visual Studio, которое предоставляет открытый экспорт MEF, реализующий `IVsCredentialProvider` тип, и соответствует описанным ниже принципам.

```cs
public interface IVsCredentialProvider
{
    Task<ICredentials> GetCredentialsAsync(
        Uri uri,
        IWebProxy proxy,
        bool isProxyRequest,
        bool isRetry,
        bool nonInteractive,
        CancellationToken cancellationToken);
}
```

Пример реализации можно найти в [примере вскредентиалпровидер](https://github.com/NuGet/Samples/tree/master/VsCredentialProvider).

Каждый поставщик учетных данных NuGet для Visual Studio должен:

1. Определите, может ли он предоставлять учетные данные для целевого URI перед инициацией получения учетных данных. Если поставщик не может предоставить учетные данные для целевого источника, он должен вернуть `null` .
1. Если поставщик обрабатывает запросы для целевого URI, но не может предоставить учетные данные, должно быть выдано исключение.

Пользовательский поставщик учетных данных NuGet для Visual Studio должен реализовывать `IVsCredentialProvider` интерфейс, доступный в [пакете NuGet. VisualStudio](https://www.nuget.org/packages/NuGet.VisualStudio/).

#### <a name="getcredentialasync"></a>жеткредентиаласинк

| Входной параметр |Описание|
| ----------------|-----------|
| URI URI | URI источника пакета, для которого запрашиваются учетные данные.|
| Прокси-сервер IWebProxy | Веб-прокси для использования при обмене данными по сети. Значение null, если проверка подлинности прокси-сервера не настроена. |
| bool Испроксирекуест | Значение true, если этот запрос должен получать учетные данные проверки подлинности прокси. Если реализация не является допустимой для получения учетных данных прокси-сервера, то должно возвращаться значение null. |
| bool, повтор | Значение true, если ранее были запрошены учетные данные для этого URI, но предоставленные учетные данные не позволяли авторизовать доступ. |
| bool Неинтерактивный | Если значение — true, поставщик учетных данных должен отключить все запросы пользователя и использовать вместо них значения по умолчанию. |
| CancellationToken cancellationToken | Этот токен отмены должен быть проверен, чтобы определить, была ли отменена операция, запрашивающая учетные данные. |

**Возвращаемое значение**: объект учетных данных, реализующий [ `System.Net.ICredentials` интерфейс](/dotnet/api/system.net.icredentials?view=netstandard-2.0).
