---
title: Кроссплатформенный подключаемый модуль проверки подлинности NuGet
description: Подключаемые модули межплатформенной проверки подлинности NuGet для NuGet. exe, DotNet. exe, MSBuild. exe и Visual Studio
author: nkolev92
ms.author: nikolev
ms.date: 07/01/2018
ms.topic: conceptual
ms.openlocfilehash: a716737343ea826d28da6de46c32ca73aef590bd
ms.sourcegitcommit: efc18d484fdf0c7a8979b564dcb191c030601bb4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/18/2019
ms.locfileid: "68317282"
---
# <a name="nuget-cross-platform-authentication-plugin"></a><span data-ttu-id="32425-103">Кроссплатформенный подключаемый модуль проверки подлинности NuGet</span><span class="sxs-lookup"><span data-stu-id="32425-103">NuGet cross platform authentication plugin</span></span>

<span data-ttu-id="32425-104">В версии 4.8 + все клиенты NuGet (NuGet. exe, Visual Studio, DotNet. exe и MSBuild. exe) могут использовать подключаемый модуль проверки подлинности, построенный на основе модели [подключаемых модулей NuGet кросс-платформы](NuGet-Cross-Platform-Plugins.md) .</span><span class="sxs-lookup"><span data-stu-id="32425-104">In version 4.8+, all NuGet clients (NuGet.exe, Visual Studio, dotnet.exe and MSBuild.exe) can use an authentication plugin built on top of the [NuGet cross platform plugins](NuGet-Cross-Platform-Plugins.md) model.</span></span>

## <a name="authentication-in-dotnetexe"></a><span data-ttu-id="32425-105">Проверка подлинности в DotNet. exe</span><span class="sxs-lookup"><span data-stu-id="32425-105">Authentication in dotnet.exe</span></span>

<span data-ttu-id="32425-106">Visual Studio и NuGet. exe по умолчанию являются интерактивными.</span><span class="sxs-lookup"><span data-stu-id="32425-106">Visual Studio and NuGet.exe are by default interactive.</span></span> <span data-ttu-id="32425-107">NuGet. exe содержит переключатель, чтобы сделать его [](../nuget-exe-CLI-Reference.md)неинтерактивным.</span><span class="sxs-lookup"><span data-stu-id="32425-107">NuGet.exe contains a switch to make it [non interactive](../nuget-exe-CLI-Reference.md).</span></span>
<span data-ttu-id="32425-108">Кроме того, модули NuGet. exe и Visual Studio запрашивают у пользователя входные данные.</span><span class="sxs-lookup"><span data-stu-id="32425-108">Additionally the NuGet.exe and Visual Studio plugins prompt the user for input.</span></span>
<span data-ttu-id="32425-109">В DotNet. exe нет запросов и значение по умолчанию — не Interactive.</span><span class="sxs-lookup"><span data-stu-id="32425-109">In dotnet.exe there is no prompting and the default is non interactive.</span></span>

<span data-ttu-id="32425-110">Механизм проверки подлинности в DotNet. exe — это поток устройства.</span><span class="sxs-lookup"><span data-stu-id="32425-110">The authentication mechanism in dotnet.exe is device flow.</span></span> <span data-ttu-id="32425-111">Если операция восстановления или добавления пакета выполняется в интерактивном режиме, блоки и инструкции для пользователя по выполнению проверки подлинности будут предоставлены в командной строке.</span><span class="sxs-lookup"><span data-stu-id="32425-111">When the restore or add package operation is run interactively, the operation blocks and instructions to the user how to complete the authentications will be provided on the command line.</span></span>
<span data-ttu-id="32425-112">Когда пользователь завершает проверку подлинности, операция будет продолжена.</span><span class="sxs-lookup"><span data-stu-id="32425-112">When the user completes the authentication the operation will continue.</span></span>

<span data-ttu-id="32425-113">Чтобы сделать операцию интерактивной, должна пройти `--interactive`одна.</span><span class="sxs-lookup"><span data-stu-id="32425-113">To make the operation interactive, one should pass `--interactive`.</span></span>
<span data-ttu-id="32425-114">В настоящее время интерактивный `dotnet add package` коммутатор поддерживает только явные `dotnet restore` команды и.</span><span class="sxs-lookup"><span data-stu-id="32425-114">Currently only the explicit `dotnet restore` and `dotnet add package` commands support an interactive switch.</span></span>
<span data-ttu-id="32425-115">Интерактивный коммутатор отсутствует в `dotnet build` и. `dotnet publish`</span><span class="sxs-lookup"><span data-stu-id="32425-115">There is no interactive switch on `dotnet build` and `dotnet publish`.</span></span>

## <a name="authentication-in-msbuild"></a><span data-ttu-id="32425-116">Проверка подлинности в MSBuild</span><span class="sxs-lookup"><span data-stu-id="32425-116">Authentication in MSBuild</span></span>

<span data-ttu-id="32425-117">Как и в DotNet. exe, MSBuild. exe по умолчанию является неинтерактивным механизмом проверки подлинности MSBuild. exe — это поток устройства.</span><span class="sxs-lookup"><span data-stu-id="32425-117">Similar to dotnet.exe, MSBuild.exe is by default non interactive the MSBuild.exe authentication mechanism is device flow.</span></span>
<span data-ttu-id="32425-118">Чтобы позволить восстановить приостановку и ожидание проверки подлинности, `msbuild -t:restore -p:NuGetInteractive="true"`Вызовите инструкцию RESTORE WITH.</span><span class="sxs-lookup"><span data-stu-id="32425-118">To allow the restore to pause and wait for authentication, call restore with `msbuild -t:restore -p:NuGetInteractive="true"`.</span></span>

## <a name="creating-a-cross-platform-authentication-plugin"></a><span data-ttu-id="32425-119">Создание подключаемого модуля межплатформенной проверки подлинности</span><span class="sxs-lookup"><span data-stu-id="32425-119">Creating a cross platform authentication plugin</span></span>

<span data-ttu-id="32425-120">Пример реализации можно найти в подключаемом [модуле поставщика учетных данных Майкрософт](https://github.com/Microsoft/artifacts-credprovider).</span><span class="sxs-lookup"><span data-stu-id="32425-120">A sample implementation can be found in [Microsoft Credential Provider plugin](https://github.com/Microsoft/artifacts-credprovider).</span></span>

<span data-ttu-id="32425-121">Очень важно, чтобы подключаемые модули применялись к требованиям безопасности, заданным в клиентских средствах NuGet.</span><span class="sxs-lookup"><span data-stu-id="32425-121">It's very important that the plugins conforms to the security requirements set forth by the NuGet client tools.</span></span>
<span data-ttu-id="32425-122">Минимальная требуемая версия подключаемого модуля должна быть подключаемым модулем проверки подлинности — *2.0.0*.</span><span class="sxs-lookup"><span data-stu-id="32425-122">The minimum required version for a plugin to be an authentication plugin is *2.0.0*.</span></span>
<span data-ttu-id="32425-123">NuGet выполняет подтверждение с помощью подключаемого модуля и запрашивает поддерживаемые утверждения операций.</span><span class="sxs-lookup"><span data-stu-id="32425-123">NuGet will perform the handshake with the plugin and query for the supported operation claims.</span></span>
<span data-ttu-id="32425-124">Дополнительные сведения о конкретных сообщениях см. [](NuGet-Cross-Platform-Plugins.md#protocol-messages-index) в сообщениях о протоколе межплатформенного подключаемого модуля NuGet.</span><span class="sxs-lookup"><span data-stu-id="32425-124">Please refer to the NuGet cross platform plugin [protocol messages](NuGet-Cross-Platform-Plugins.md#protocol-messages-index) for more details about the specific messages.</span></span>

<span data-ttu-id="32425-125">NuGet устанавливает уровень ведения журнала и предоставляет подключаемому модулю сведения о прокси-сервере, если это применимо.</span><span class="sxs-lookup"><span data-stu-id="32425-125">NuGet will set the log level and provide proxy information to the plugin when applicable.</span></span>
<span data-ttu-id="32425-126">Ведение журнала в консоли NuGet допустимо только после того, как NuGet установила уровень ведения журнала для подключаемого модуля.</span><span class="sxs-lookup"><span data-stu-id="32425-126">Logging to the NuGet console is only acceptable after NuGet has set the log level to the plugin.</span></span>

- <span data-ttu-id="32425-127">Поведение проверки подлинности подключаемого модуля .NET Framework</span><span class="sxs-lookup"><span data-stu-id="32425-127">.NET Framework plugin authentication behavior</span></span>

<span data-ttu-id="32425-128">В .NET Framework подключаемые модули могут запрашивать у пользователя ввод в виде диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="32425-128">In .NET Framework, the plugins are allowed to prompt a user for input, in the form of a dialog.</span></span>

- <span data-ttu-id="32425-129">Поведение проверки подлинности подключаемого модуля .NET Core</span><span class="sxs-lookup"><span data-stu-id="32425-129">.NET Core plugin authentication behavior</span></span>

<span data-ttu-id="32425-130">В .NET Core невозможно отобразить диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="32425-130">In .NET Core, a dialog cannot be shown.</span></span> <span data-ttu-id="32425-131">Подключаемые модули должны использовать поток устройства для проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="32425-131">The plugins should use device flow to authenticate.</span></span>
<span data-ttu-id="32425-132">Подключаемый модуль может отправить сообщения журнала в NuGet с инструкциями для пользователя.</span><span class="sxs-lookup"><span data-stu-id="32425-132">The plugin can send log messages to NuGet with instructions to the user.</span></span>
<span data-ttu-id="32425-133">Обратите внимание, что ведение журнала доступно после того, как уровень ведения журнала установлен для подключаемого модуля.</span><span class="sxs-lookup"><span data-stu-id="32425-133">Note that logging is available after the log level has been set to the plugin.</span></span>
<span data-ttu-id="32425-134">NuGet не будет принимать Интерактивные входные данные из командной строки.</span><span class="sxs-lookup"><span data-stu-id="32425-134">NuGet will not take any interactive input from the command line.</span></span>

<span data-ttu-id="32425-135">Когда клиент вызывает подключаемый модуль с учетными данными получения для проверки подлинности, подключаемые модули должны соответствовать переключателю взаимодействия и соблюдать параметр диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="32425-135">When the client calls the plugin with a Get Authentication Credentials, the plugins need to conform to the interactivity switch and respect the dialog switch.</span></span> 

<span data-ttu-id="32425-136">В следующей таблице приведена сводка поведения подключаемого модуля для всех сочетаний.</span><span class="sxs-lookup"><span data-stu-id="32425-136">The following table summarizes how the plugin should behave for all combinations.</span></span>

| <span data-ttu-id="32425-137">иснонинтерактиве</span><span class="sxs-lookup"><span data-stu-id="32425-137">IsNonInteractive</span></span> | <span data-ttu-id="32425-138">каншовдиалог</span><span class="sxs-lookup"><span data-stu-id="32425-138">CanShowDialog</span></span> | <span data-ttu-id="32425-139">Поведение подключаемого модуля</span><span class="sxs-lookup"><span data-stu-id="32425-139">Plugin behavior</span></span> |
| ---------------- | ------------- | --------------- |
| <span data-ttu-id="32425-140">true</span><span class="sxs-lookup"><span data-stu-id="32425-140">true</span></span> | <span data-ttu-id="32425-141">true</span><span class="sxs-lookup"><span data-stu-id="32425-141">true</span></span> | <span data-ttu-id="32425-142">Параметр Иснонинтерактиве имеет приоритет над параметром диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="32425-142">The IsNonInteractive switch takes precedence over the dialog switch.</span></span> <span data-ttu-id="32425-143">Подключаемому модулю не разрешено открывать диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="32425-143">The plugin is not allowed to pop a dialog.</span></span> <span data-ttu-id="32425-144">Это сочетание допустимо только для подключаемых модулей .NET Framework</span><span class="sxs-lookup"><span data-stu-id="32425-144">This combination is only valid for .NET Framework plugins</span></span> |
| <span data-ttu-id="32425-145">true</span><span class="sxs-lookup"><span data-stu-id="32425-145">true</span></span> | <span data-ttu-id="32425-146">False</span><span class="sxs-lookup"><span data-stu-id="32425-146">false</span></span> | <span data-ttu-id="32425-147">Параметр Иснонинтерактиве имеет приоритет над параметром диалогового окна.</span><span class="sxs-lookup"><span data-stu-id="32425-147">The IsNonInteractive switch takes precedence over the dialog switch.</span></span> <span data-ttu-id="32425-148">Не допускается блокирование подключаемого модуля.</span><span class="sxs-lookup"><span data-stu-id="32425-148">The plugin is not allowed to block.</span></span> <span data-ttu-id="32425-149">Это сочетание допустимо только для подключаемых модулей .NET Core</span><span class="sxs-lookup"><span data-stu-id="32425-149">This combination is only valid for .NET Core plugins</span></span> |
| <span data-ttu-id="32425-150">False</span><span class="sxs-lookup"><span data-stu-id="32425-150">false</span></span> | <span data-ttu-id="32425-151">true</span><span class="sxs-lookup"><span data-stu-id="32425-151">true</span></span> | <span data-ttu-id="32425-152">Подключаемый модуль должен отображать диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="32425-152">The plugin should show a dialog.</span></span> <span data-ttu-id="32425-153">Это сочетание допустимо только для подключаемых модулей .NET Framework</span><span class="sxs-lookup"><span data-stu-id="32425-153">This combination is only valid for .NET Framework plugins</span></span> |
| <span data-ttu-id="32425-154">False</span><span class="sxs-lookup"><span data-stu-id="32425-154">false</span></span> | <span data-ttu-id="32425-155">False</span><span class="sxs-lookup"><span data-stu-id="32425-155">false</span></span> | <span data-ttu-id="32425-156">Подключаемый модуль должен отображать диалоговое окно или не может его отобразить.</span><span class="sxs-lookup"><span data-stu-id="32425-156">The plugin should/can not show a dialog.</span></span> <span data-ttu-id="32425-157">Подключаемый модуль должен использовать поток устройства для проверки подлинности, записывая сообщение инструкции через средство ведения журнала.</span><span class="sxs-lookup"><span data-stu-id="32425-157">The plugin should use device flow to authenticate by logging an instruction message via the logger.</span></span> <span data-ttu-id="32425-158">Это сочетание допустимо только для подключаемых модулей .NET Core</span><span class="sxs-lookup"><span data-stu-id="32425-158">This combination is only valid for .NET Core plugins</span></span> |

<span data-ttu-id="32425-159">Перед созданием подключаемого модуля Ознакомьтесь со следующими спецификациями.</span><span class="sxs-lookup"><span data-stu-id="32425-159">Please refer to the following specs before writing a plugin.</span></span>

- [<span data-ttu-id="32425-160">Подключаемый модуль скачивания пакетов NuGet</span><span class="sxs-lookup"><span data-stu-id="32425-160">NuGet Package Download Plugin</span></span>](https://github.com/NuGet/Home/wiki/NuGet-Package-Download-Plugin)
- [<span data-ttu-id="32425-161">Подключаемый модуль Plat проверки подлинности NuGet</span><span class="sxs-lookup"><span data-stu-id="32425-161">NuGet cross plat authentication plugin</span></span>](https://github.com/NuGet/Home/wiki/NuGet-cross-plat-authentication-plugin)
