---
title: Поставщики учетных данных nuget.exe
description: nuget.exe поставщики учетных данных проходят проверку подлинности с помощью веб-канала и реализуются в виде исполняемых файлов командной строки, которые следуют конкретным соглашениям.
author: karann-msft
ms.author: karann
ms.date: 12/12/2017
ms.topic: conceptual
ms.openlocfilehash: 41e3e63138351bafd5e3a56080268faef10d85a3
ms.sourcegitcommit: b138bc1d49fbf13b63d975c581a53be4283b7ebf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2020
ms.locfileid: "93238118"
---
# <a name="authenticating-feeds-with-nugetexe-credential-providers"></a>Проверка подлинности веб-каналов с помощью nuget.exe поставщиков учетных данных

В `3.3` службе поддержки версий была добавлена поддержка `nuget.exe` конкретных поставщиков учетных данных. С этого момента `4.8` была добавлена [Поддержка версий для поставщиков учетных данных](NuGet-Cross-Platform-Authentication-Plugin.md) , которые работают во всех сценариях командной строки ( `nuget.exe` , `dotnet.exe` , `msbuild.exe` ).

Дополнительные сведения о всех подходах проверки подлинности для см. в статье [Использование пакетов из прошедших проверку подлинности каналов](../../consume-packages/consuming-packages-authenticated-feeds.md#nugetexe) . `nuget.exe`

## <a name="nugetexe-credential-provider-discovery"></a>Обнаружение поставщика учетных данных nuget.exe

nuget.exe поставщики учетных данных можно использовать тремя способами:

- **Глобально** : чтобы предоставить поставщику учетных данных доступ ко всем экземплярам `nuget.exe` , запущенным с использованием профиля текущего пользователя, добавьте его в `%LocalAppData%\NuGet\CredentialProviders` . Возможно, потребуется создать `CredentialProviders` папку. Поставщики учетных данных можно установить в корне `CredentialProviders`  папки или во вложенной папке. Если поставщик учетных данных имеет несколько файлов или сборок, можно использовать вложенные папки для упорядочения поставщиков.

- **Из переменной среды** . поставщики учетных данных можно хранить в любом месте и предоставлять к ним доступ `nuget.exe` , присвоив `%NUGET_CREDENTIALPROVIDERS_PATH%` переменной среды расположение поставщика. Эта переменная может быть списком, разделенным точкой с запятой (например, `path1;path2` ), если имеется несколько расположений.

- **Вместе с nuget.exe** : nuget.exe поставщиков учетных данных можно поместить в ту же папку, что и `nuget.exe` .

При загрузке поставщиков учетных данных `nuget.exe` выполняет поиск в указанных выше расположениях для любого файла с именем `credentialprovider*.exe` , а затем загружает эти файлы в том порядке, в котором они найдены. Если в одной папке есть несколько поставщиков учетных данных, они загружаются в алфавитном порядке.

## <a name="creating-a-nugetexe-credential-provider"></a>Создание nuget.exe поставщика учетных данных

Поставщик учетных данных — это исполняемый файл командной строки, названный в форме `CredentialProvider*.exe` , собирающий входные данные, получающий соответствующие полномочия, а затем возвращающий соответствующий код состояния выхода и стандартные выходные данные.

Поставщик должен выполнить следующие действия:

- Определите, может ли он предоставлять учетные данные для целевого URI перед инициацией получения учетных данных. В противном случае возвращается код состояния 1 без учетных данных.
- Не изменять `Nuget.Config` (например, задать учетные данные).
- Самостоятельно обрабатывайте конфигурацию HTTP-прокси, так как NuGet не предоставляет подключаемому модулю сведения о прокси-сервере.
- Верните учетные данные или сведения об ошибке `nuget.exe` , записав объект ответа JSON (см. ниже) в stdout, используя кодировку UTF-8.
- При необходимости выдает дополнительные возможности ведения журнала трассировки в stderr. Никакие секреты не должны записываться в stderr, так как при уровне детализации "нормальная" или "детально" такие трассировки выводятся с помощью NuGet на консоль.
- Непредусмотренные параметры следует игнорировать, обеспечивая прямую совместимость с будущими версиями NuGet.

### <a name="input-parameters"></a>Входные параметры

| Параметр или переключатель |Описание|
|----------------|-----------|
| URI {value} | URI источника пакета, которому требуются учетные данные.|
| NonInteractive | Если он указан, то поставщик не выдает интерактивных запросов. |
| Повтор | При наличии указывает, что эта попытка является повторной попыткой ранее неудачной попытки. Поставщики обычно используют этот флаг, чтобы убедиться, что они обходят любой существующий кэш и запрашивают новые учетные данные, если это возможно.|
| Уровень детализации {value} | При наличии одного из следующих значений: "Обычная", "Quiet" или "Detailed". Если значение не указано, по умолчанию используется "Обычная". Поставщики должны использовать это как показатель уровня дополнительного ведения журнала, выдаваемое в стандартный поток ошибок. |

### <a name="exit-codes"></a>Коды выхода

| Код |Результат | Описание |
|----------------|-----------|-----------|
| 0 | Успех | Учетные данные успешно получены и записаны в stdout.|
| 1 | провидернотаппликабле | Текущий поставщик не предоставляет учетные данные для данного URI.|
| 2 | Сбой | Поставщик является верным поставщиком для данного URI, но не может предоставить учетные данные. В этом случае nuget.exe не будет повторять проверку подлинности и завершится ошибкой. Типичный пример — когда пользователь отменяет интерактивное имя входа. |

### <a name="standard-output"></a>Стандартные выходные данные

| Свойство |Примечания|
|----------------|-----------|
| Имя пользователя | Имя пользователя для проверенных запросов.|
| Пароль | Пароль для запросов, прошедших проверку подлинности.|
| Сообщение | Дополнительные сведения о ответе используются только для отображения дополнительных сведений в случаях сбоя. |

Пример stdout:

    { "Username" : "freddy@example.com",
      "Password" : "bwm3bcx6txhprzmxhl2x63mdsul6grctazoomtdb6kfbof7m3a3z",
      "Message"  : "" }

## <a name="troubleshooting-a-credential-provider"></a>Устранение неполадок поставщика учетных данных

В настоящее время NuGet не предоставляет значительной поддержки для отладки пользовательских поставщиков учетных данных. [проблема 4598](https://github.com/NuGet/Home/issues/4598) отслеживает эту работу.

Можно выполнить следующие действия:

- Запустите nuget.exe с `-verbosity` параметром, чтобы просмотреть подробные выходные данные.
- Добавьте отладочные сообщения в `stdout` соответствующие места.
- Убедитесь, что вы используете nuget.exe 3,3 или более поздней версии.
- Присоединить отладчик при запуске с помощью этого фрагмента кода:

    ```cs
    while (!Debugger.IsAttached)
    {
        System.Threading.Thread.Sleep(100);
    }
    Debugger.Break();
    ```
