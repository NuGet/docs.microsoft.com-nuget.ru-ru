---
title: Влияние project.json на авторов пакетов NuGet
description: Сведения о том, как реализация project.json в NuGet 3.x влияет на авторов пакетов, например неподдерживаемые функции, содержимое и формат пакетов.
author: JonDouglas
ms.author: jodou
ms.date: 01/18/2018
ms.topic: conceptual
ms.openlocfilehash: 82b7ce7962ecccc9559ae25a8fe35a3820238049
ms.sourcegitcommit: ee6c3f203648a5561c809db54ebeb1d0f0598b68
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/26/2021
ms.locfileid: "98775389"
---
# <a name="impact-of-projectjson-when-creating-packages"></a>Влияние project.json при создании пакетов

> [!Important]
> Это содержимое является устаревшим. Проекты должны использовать формат `packages.config` или PackageReference.

Система `project.json`, используемая в NuGet 3+, влияет на авторов пакетов несколькими разными способами, описанными в следующих разделах.

## <a name="changes-affecting-existing-packages-usage"></a>Изменения, затрагивающие использование существующих пакетов

Традиционные пакеты NuGet поддерживают набор функций, которые не переносятся в транзитивный мир.

### <a name="install-and-uninstall-scripts-are-ignored"></a>Скрипты установки и удаления игнорируются

В модели транзитивного восстановления, описанной в разделе [Разрешение зависимостей](../concepts/dependency-resolution.md#dependency-resolution-with-packagereference), отсутствует понятие "время установки пакета". Пакет присутствует или отсутствует, но не существует никакого согласованного процесса, реализуемого при установке пакета.

Кроме того, скрипты установки поддерживались только в Visual Studio. Другим интегрированным средам разработки для поддержки таких скриптов пришлось имитировать API расширяемости Visual Studio, а в распространенных редакторах и программах командной строки такая поддержка отсутствовала.

### <a name="content-transforms-are-not-supported"></a>Преобразования содержимого не поддерживаются.

Подобно скриптам установки, преобразования запускаются при установке пакета и обычно не являются идемпотентными. Так как времени установки больше нет, XDT Transform и другие аналогичные компоненты не поддерживаются и игнорируются при использовании такого пакета в транзитивном сценарии.

### <a name="content"></a>Содержимое

К традиционным пакетам NuGet прилагаются файлы содержимого, например файлы исходного кода и конфигурации. Обычно они используются в двух сценариях:

1. Начальные файлы помещаются в проект, чтобы пользователь мог изменить их позднее. Типичным примером являются файлы конфигурации по умолчанию.

1. Файлы содержимого сопровождают сборки, установленные в проекте. В качестве примера здесь можно привести изображение логотипа, используемое в сборке.

Поддержка содержимого сейчас отключена по тем же причинам, что и скрипты и преобразования, но мы ведем работу в этом направлении.

Файлы содержимого по-прежнему можно переносить внутри пакетов. Сейчас они игнорируются, однако конечный пользователь по-прежнему может скопировать их в нужное место.

Вы можете просмотреть одно из предложений по возвращению файлов содержимого и отследить ход его реализации: [https://github.com/NuGet/Home/issues/627](https://github.com/NuGet/Home/issues/627).

## <a name="impact-for-package-authors"></a>Влияние на авторов пакетов

Пакетам с указанными выше функциями придется использовать другой механизм. В общем случае наиболее удобным механизмом являются целевые объекты и свойства MSBuild, которые полностью поддерживаются. Система сборки может использовать другие соглашения в пакете. Именно так обеспечивается поддержка целевых объектов MSBuild, а также анализаторов Roslyn. Можно создавать пакеты, поддерживающие целевые объекты и анализаторы для сценариев `packages.config` и `project.json`.

Пакеты, которые пытаются изменить проект для упрощения запуска, обычно функционируют лишь в ограниченном наборе сценариев, и вместо этого им следует предоставлять файл сведений или указания по использованию пакета.

Большинству существующих пакетов не потребуется использовать описанный ниже формат пакета.

Этот формат позволяет использовать собственное содержимое в привилегированном сценарии. Это означает, что управляемые сборки, зависящие от приближенных к оборудованию реализаций, предоставляют двоичные реализации наряду с управляемыми сборками в зависимости от целевой платформы. Например, эту технологию использует пакет System.IO.Compression. [https://www.nuget.org/packages/System.IO.Compression](https://www.nuget.org/packages/System.IO.Compression)

Таким образом, если описанные выше функции не являются обязательными, мы рекомендуем использовать существующий формат пакета, так как описанный здесь формат поддерживается только NuGet 3.x+.

Создание пакетов, одновременно подходящих для сценариев `packages.config` и `project.json`, возможно при помощи оболочек совместимости, но часто проще структурировать пакеты традиционным образом, не прибегая к указанным выше нерекомендуемым функциям.

## <a name="3x-package-format"></a>Формат пакета 3.x

Формат пакета 3.x предоставляет несколько дополнительных функций по сравнению с форматом NuGet 2.x:

1. Определение базовой сборки, используемой для компиляции, и набора сборок реализации, используемых во время выполнения на разных платформах и устройствах. Это позволяет вам воспользоваться преимуществами API для конкретной платформы, а также предоставляет потребителям общую контактную зону. В частности, это упрощает написание промежуточных переносимых библиотек.

1. Позволяет пакетам выполнять сводку по платформам, например операционным системам или архитектуре ЦП.

1. Обеспечивает разделение реализаций для конкретной платформы по дополнительным пакетам.

1. Поддержка собственных зависимостей в качестве привилегированного компонента.
